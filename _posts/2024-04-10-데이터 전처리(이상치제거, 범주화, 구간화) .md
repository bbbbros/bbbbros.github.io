# Python 활용한 데이터 전처리/시각화
# Chapter 1. 데이터 전처리
 
데이터 분석/AI 모델링을 위하여 데이터를 정제하는 전처리 방법을 실습해 봅시다.    
우선 확보한 데이터를 전처리를 위해 불러옵니다.     


```python
# 판다스 불러오기
import pandas as pd
```

sc_cust_info_txn_v1.5.csv파일을 읽어 데이터를 불러 올 수 있습니다. 


```python
#개별 환경 사용자
df=pd.read_csv("sc_cust_info_txn_v1.5.csv")
```


```python
print(df)
print("===============================================================")
```

          base_ym  dpro_tgt_perd_val  cust_ctg_type cust_class sex_type age  \
    0      202006           20200630          10001          C        F  28   
    1      202006           20200630          10001          _        _   _   
    2      202006           20200630          10001          E        F  24   
    3      202006           20200630          10001          F        F  32   
    4      202006           20200630          10001          D        M  18   
    ...       ...                ...            ...        ...      ...  ..   
    9925   202006           20200630          10001          C        F  15   
    9926   202006           20200630          10001          G        M  12   
    9927   202006           20200630          10005          C        _   _   
    9928   202006           20200630          10001          C        F  40   
    9929   202006           20200630          10001          C        F  59   
    
          efct_svc_count dt_stop_yn npay_yn  r3m_avg_bill_amt  r3m_A_avg_arpu_amt  \
    0                  0          N       N         2640.0000          792.000000   
    1                  1          N       N          300.0000           90.000000   
    2                  1          N       N        16840.0000         2526.000000   
    3                  1          N       N        15544.7334         2331.710010   
    4                  1          N       N         4700.0000            0.000000   
    ...              ...        ...     ...               ...                 ...   
    9925               1          N       Y         1296.0999          194.414985   
    9926               1          N       N        13799.6666         2069.949990   
    9927               1          N       N         1396.2000         1206.000000   
    9928               0          N       N         3140.0000          942.000000   
    9929               1          N       N         2436.9000          365.535000   
    
          r3m_B_avg_arpu_amt  r6m_A_avg_arpu_amt  r6m_B_avg_arpu_amt  \
    0              1584.0000                 0.0              0.0000   
    1               180.0000                 0.0              0.0000   
    2              6983.0000                 0.0           6981.0000   
    3              6750.4666                 0.0           6508.8000   
    4              4502.0000                 0.0           4507.7000   
    ...                  ...                 ...                 ...   
    9925            643.1001                 0.0            852.5499   
    9926          10605.9266                 0.0          10603.9266   
    9927              0.0000              1212.0              0.0000   
    9928           1884.0000                 0.0              0.0000   
    9929           1839.9000                 0.0           1919.7999   
    
         termination_yn  
    0                 Y  
    1                 Y  
    2                 N  
    3                 N  
    4                 N  
    ...             ...  
    9925              N  
    9926              N  
    9927              N  
    9928              Y  
    9929              N  
    
    [9930 rows x 15 columns]
    ===============================================================


    

<br><br>
## 1. 데이터 탐색하기
### <b>데이터 확인하기</b>
Dataframe에서 제공하는 메소드를 활용하여 데이터의 구성을 확인합니다.    
info는 데이터 구성과 특성을 확인해 볼 수 있습니다


```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9930 entries, 0 to 9929
    Data columns (total 15 columns):
     #   Column              Non-Null Count  Dtype  
    ---  ------              --------------  -----  
     0   base_ym             9930 non-null   int64  
     1   dpro_tgt_perd_val   9930 non-null   int64  
     2   cust_ctg_type       9930 non-null   int64  
     3   cust_class          9930 non-null   object 
     4   sex_type            9930 non-null   object 
     5   age                 9930 non-null   object 
     6   efct_svc_count      9930 non-null   int64  
     7   dt_stop_yn          9930 non-null   object 
     8   npay_yn             9930 non-null   object 
     9   r3m_avg_bill_amt    9930 non-null   float64
     10  r3m_A_avg_arpu_amt  9930 non-null   float64
     11  r3m_B_avg_arpu_amt  9930 non-null   float64
     12  r6m_A_avg_arpu_amt  9930 non-null   float64
     13  r6m_B_avg_arpu_amt  9930 non-null   float64
     14  termination_yn      9930 non-null   object 
    dtypes: float64(5), int64(4), object(6)
    memory usage: 1.1+ MB


head와 tail은 sample 데이터 확인이 가능합니다.     


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>base_ym</th>
      <th>dpro_tgt_perd_val</th>
      <th>cust_ctg_type</th>
      <th>cust_class</th>
      <th>sex_type</th>
      <th>age</th>
      <th>efct_svc_count</th>
      <th>dt_stop_yn</th>
      <th>npay_yn</th>
      <th>r3m_avg_bill_amt</th>
      <th>r3m_A_avg_arpu_amt</th>
      <th>r3m_B_avg_arpu_amt</th>
      <th>r6m_A_avg_arpu_amt</th>
      <th>r6m_B_avg_arpu_amt</th>
      <th>termination_yn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>_</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>0.0</td>
      <td>6981.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>0.0</td>
      <td>6508.8</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>0.0</td>
      <td>4507.7</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
 df.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>base_ym</th>
      <th>dpro_tgt_perd_val</th>
      <th>cust_ctg_type</th>
      <th>cust_class</th>
      <th>sex_type</th>
      <th>age</th>
      <th>efct_svc_count</th>
      <th>dt_stop_yn</th>
      <th>npay_yn</th>
      <th>r3m_avg_bill_amt</th>
      <th>r3m_A_avg_arpu_amt</th>
      <th>r3m_B_avg_arpu_amt</th>
      <th>r6m_A_avg_arpu_amt</th>
      <th>r6m_B_avg_arpu_amt</th>
      <th>termination_yn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9925</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>C</td>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>0.0</td>
      <td>852.5499</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>G</td>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>0.0</td>
      <td>10603.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10005</td>
      <td>C</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>1212.0</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>C</td>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>202006</td>
      <td>20200630</td>
      <td>10001</td>
      <td>C</td>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>0.0</td>
      <td>1919.7999</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>



describe를 통해 수학적 통계를 확인해 보는 작업도 해봅시다.


```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>base_ym</th>
      <th>dpro_tgt_perd_val</th>
      <th>cust_ctg_type</th>
      <th>efct_svc_count</th>
      <th>r3m_avg_bill_amt</th>
      <th>r3m_A_avg_arpu_amt</th>
      <th>r3m_B_avg_arpu_amt</th>
      <th>r6m_A_avg_arpu_amt</th>
      <th>r6m_B_avg_arpu_amt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>9930.0</td>
      <td>9930.0</td>
      <td>9930.000000</td>
      <td>9930.000000</td>
      <td>9.930000e+03</td>
      <td>9.930000e+03</td>
      <td>9.930000e+03</td>
      <td>9.930000e+03</td>
      <td>9930.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10001.372810</td>
      <td>1.520040</td>
      <td>1.181774e+04</td>
      <td>1.897536e+03</td>
      <td>6.395259e+03</td>
      <td>8.496206e+02</td>
      <td>4624.897630</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.605016</td>
      <td>15.404037</td>
      <td>1.397822e+05</td>
      <td>1.235342e+04</td>
      <td>8.346138e+04</td>
      <td>1.235124e+04</td>
      <td>4561.049131</td>
    </tr>
    <tr>
      <th>min</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10001.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10001.000000</td>
      <td>1.000000</td>
      <td>3.624503e+03</td>
      <td>3.240000e+02</td>
      <td>1.260000e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10001.000000</td>
      <td>1.000000</td>
      <td>8.284467e+03</td>
      <td>1.593307e+03</td>
      <td>4.768617e+03</td>
      <td>0.000000e+00</td>
      <td>3959.316700</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10001.000000</td>
      <td>1.000000</td>
      <td>1.372000e+04</td>
      <td>2.308360e+03</td>
      <td>7.982000e+03</td>
      <td>1.006125e+03</td>
      <td>7741.006900</td>
    </tr>
    <tr>
      <th>max</th>
      <td>202006.0</td>
      <td>20200630.0</td>
      <td>10010.000000</td>
      <td>905.000000</td>
      <td>1.281568e+07</td>
      <td>1.188998e+06</td>
      <td>7.689409e+06</td>
      <td>1.208498e+06</td>
      <td>64947.092000</td>
    </tr>
  </tbody>
</table>
</div>



 

### <b>필요한 컬럼만 추출하기</b>
수집한 데이터의 컬럼이 너무 많을 경우 데이터 처리에 불필요한 시간과 자원이 계속 소모 되기에,     
이번 수업에서는 필요한 컬럼만 추출하여 데이터처리를 하도록 하겠습니다.    
실제 분석/모델링에서는 어떤 컬럼이 중요할지 알수 없기 떄문에 자원이 가능한 많은 데이터를 가지고 하셔도 좋습니다. 


```python
#데이터 처리에 필요한 10개 항목만 추출
#고객등급(cust_class), 성별(sex_type), 나이(age), 사용서비스수(efct_svc_count), 서비스중지여부 (dt_stop_yn), 미납여부(npay_yn)
#3개월 평균 요금(r3m_avg_bill_amt), A서비스 3개월 평균요금(r3m_A_avg_arpu_amt), B서비스 3개월 평균요금(r3m_B_avg_arpu_amt), 해지여부(termination_yn)

cust = df[['cust_class', 'sex_type', 'age', 'efct_svc_count', 'dt_stop_yn', 'npay_yn', 'r3m_avg_bill_amt', 'r3m_A_avg_arpu_amt', 'r3m_B_avg_arpu_amt', 'termination_yn']]
cust.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_class</th>
      <th>sex_type</th>
      <th>age</th>
      <th>efct_svc_count</th>
      <th>dt_stop_yn</th>
      <th>npay_yn</th>
      <th>r3m_avg_bill_amt</th>
      <th>r3m_A_avg_arpu_amt</th>
      <th>r3m_B_avg_arpu_amt</th>
      <th>termination_yn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>_</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>



실습의 편의를 위해 컬럼명을 조금 더 간결하고 직관적으로 변경해 보겠습니다.     
실제 여러명이 동시에 진행하는 분석 프로젝트나 모델링에서는 정해진 네이밍 룰에 따라 변경하거나 원천 컬럼명을 그대로 사용하는 것이 좋습니다. 


```python
# 컬럼명을 간결하고 직관적으로 변경해 줍시다.
cust = cust.rename(columns={'cust_class':'class', 'sex_type':'sex', 'efct_svc_count':'service', 'dt_stop_yn':'stop', 'npay_yn':'npay', 'r3m_avg_bill_amt':'avg_bill', 'r3m_A_avg_arpu_amt':'A_bill', 'r3m_B_avg_arpu_amt':'B_bill', 'termination_yn':'termination'})
cust


```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>_</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>




```python
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9930 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        9930 non-null   object 
     1   sex          9930 non-null   object 
     2   age          9930 non-null   object 
     3   service      9930 non-null   int64  
     4   stop         9930 non-null   object 
     5   npay         9930 non-null   object 
     6   avg_bill     9930 non-null   float64
     7   A_bill       9930 non-null   float64
     8   B_bill       9930 non-null   float64
     9   termination  9930 non-null   object 
    dtypes: float64(3), int64(1), object(6)
    memory usage: 775.9+ KB



```python
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>_</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>_</td>
      <td>_</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>



 

### <b>데이터 타입 변경하기</b>
데이터를 불러온 후에는 반드시 데이터 타입을 확인해 주시는것이 좋습니다.    
숫자형 데이터가 문자형으로 지정되어 있거나 혹은 그반의 경우 원하는 데이터 처리 결과가 도출 되지 않을 수 있습니다.


```python
# 결측치 처리  <이렇게 처리함>
# import numpy as np
# cust = cust.replace('_', np.NaN)
# cust = cust.astype({'age':float})
```


```python
# 숫자형 데이터가 문자형으로 저장된 경우의 사칙연산
cust['age'][3]+cust['age'][4]
```




    '3218'




```python
#age 항목을 Intger type으로 변경
# cust=cust.astype({'age': int}) # #결측치가 문자 '_'로 되어있어 에러발생 int로 변환을 실패하여 에러
```


```python
#"_" 항목을 NaN 값으로 치환
import numpy as np
cust = cust.replace("_", np.NaN)
```


```python
cust.info()
cust
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9930 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8529 non-null   object 
     1   sex          9249 non-null   object 
     2   age          9178 non-null   object 
     3   service      9930 non-null   int64  
     4   stop         9930 non-null   object 
     5   npay         9930 non-null   object 
     6   avg_bill     9930 non-null   float64
     7   A_bill       9930 non-null   float64
     8   B_bill       9930 non-null   float64
     9   termination  9930 non-null   object 
    dtypes: float64(3), int64(1), object(6)
    memory usage: 775.9+ KB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>




```python
#age 항목의 type 변경
#NaN의 경우 int type을 지원하지 않아 float type으로 변경
cust=cust.astype({'age': float })
```


```python
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9930 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8529 non-null   object 
     1   sex          9249 non-null   object 
     2   age          9178 non-null   float64
     3   service      9930 non-null   int64  
     4   stop         9930 non-null   object 
     5   npay         9930 non-null   object 
     6   avg_bill     9930 non-null   float64
     7   A_bill       9930 non-null   float64
     8   B_bill       9930 non-null   float64
     9   termination  9930 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 775.9+ KB



```python
cust.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>



 

<br><br>
## 2. 결측치 처리하기
### <span style="color:RED">주의!!</span> 데이터 결측치 처리시 반드시 원본 데이터를 COPY 해서 사용할것!!
파이썬에서 Copy 메소드를 사용하지 않으면 주소값을 복사해서 사용기 때문에 원본 값을 변경 시키게 됩니다.    
따라서 원본 항목을 보전하면서 데이터를 보정하려면 copy 메소드를 사용 해주셔야 합니다.


```python
# Cust Data 복사
cust_fix=cust.copy()
cust_fix.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
test=cust
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
test['age']=0
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
# test 데이터 변경 후 Cust 데이터 확인
cust.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Copy 메소드로 변경한 Cust_fix 데이터 확인
cust_fix.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust=cust_fix.copy()
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>



### <b>결측치 채우기 </b>

다음은 사용자가 지정하는 단일값으로 채워서 결측치를 처리하는 방법입니다.


```python
#fillna 함수를 사용해서 특정 숫자나 문자로 결측치를 처리하는 방법
cust=cust.fillna(15)
cust.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>15</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.00000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 9930 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        9930 non-null   object 
     1   sex          9930 non-null   object 
     2   age          9930 non-null   float64
     3   service      9930 non-null   int64  
     4   stop         9930 non-null   object 
     5   npay         9930 non-null   object 
     6   avg_bill     9930 non-null   float64
     7   A_bill       9930 non-null   float64
     8   B_bill       9930 non-null   float64
     9   termination  9930 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 775.9+ KB


fillna의 Method 파라미터를 사용하면,     
사용자가 지정하는 일괄적인 값이 아닌 주변값을 활용하여 결측치를 채울수 있습니다.


```python
# 뒤에 있는 data를 사용해서 결측치를 처리하는 방법
cust=cust_fix.copy()
# cust
cust=cust.fillna(method='bfill')
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>




```python
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>




```python
# 앞에 있는 data를 사용해서 결측치를 처리하는 방법
cust=cust_fix.copy()
cust=cust.fillna(method='ffill')
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>



주의! Method 파리미터사용시 첫 Record 또는 마지막 Record가 결측치 인지 확인해야 합니다.    

Replace 함수를 사용해도 결측치 채우기가 가능합니다.
중위값 결측치 채우기 예제


```python
#replace()함수로 결측치 채우기 중위값으로 채우기
cust=cust_fix.copy()
cust['age'].replace(np.NaN, cust['age'].median(),inplace=True)
cust

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>NaN</td>
      <td>49.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>9930 rows × 10 columns</p>
</div>



interpolate() 함수로 결측치 채우기     
선형방식은 값들을 같은 간격으로 처리하게된다.


```python
# interpolate 함수의 선형 방법을 사용하여 결측값을 채우기
cust=cust_fix.copy()  ## 춧자만 보간한다.

cust['age'].interpolate()

# cust.interpolate()




# cust=cust.interpolate()
# cust.head()
```




    0       28.0
    1       26.0
    2       24.0
    3       32.0
    4       18.0
            ... 
    9925    15.0
    9926    12.0
    9927    26.0
    9928    40.0
    9929    59.0
    Name: age, Length: 9930, dtype: float64





### <b>결측치 제거하기</b>
결측치를 채우기로 처리하다보면 경우에 따라 값의 왜곡이 크게 발생하는 발생 하는 경우가 있습니다.    
이때는 제거하기 기법을 사용하여 결측치를 처리하면 데이터의 정합성을 보존 할 수 있습니다.

* listwise 방식 : record의 항목 중 1개의 값이라도 NA이면 해당 데이터 행 전체 제거
* pairwise 방식 : 모든 항목이 NA인 데이터 행만 제거

* cust = cust.dropna(how='any') # null이 하나라도 있으면 그 행 삭제
* cust
* cust = cust.dropna(how='all') # 전체행이 null일 경우만 그 행 삭제


```python
#listwise 방식으로 제거 하기
cust=cust_fix.copy()
cust=cust.dropna() # 한개라도 NA가 있으면 전체 삭제
cust
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.999900</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>C</td>
      <td>M</td>
      <td>76.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1860.0000</td>
      <td>1716.000000</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
<p>8228 rows × 10 columns</p>
</div>




```python
#pairwise 방식으로 제거하기
cust=cust_fix.copy()
cust=cust.dropna(how='all')  # 전체가 NA일때 삭제
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 9930 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8529 non-null   object 
     1   sex          9249 non-null   object 
     2   age          9178 non-null   float64
     3   service      9930 non-null   int64  
     4   stop         9930 non-null   object 
     5   npay         9930 non-null   object 
     6   avg_bill     9930 non-null   float64
     7   A_bill       9930 non-null   float64
     8   B_bill       9930 non-null   float64
     9   termination  9930 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 853.4+ KB



```python
#pairwise 방식 확인을 위한 데이터 임의 변경
cust = cust_fix.copy()
cust[['npay', 'stop', 'termination']] = cust[['npay', 'stop', 'termination']].replace('N', np.NaN)
cust[['service','avg_bill', 'A_bill', 'B_bill']] = cust[['service','avg_bill', 'A_bill', 'B_bill']].replace(0, np.NaN)


# null 값 조회
# cust[cust.isna().any(axis=True)]

# 특정 column null값 조회
# cust[cust.termination.isna()]
# cust[(cust['termination'].isna())]


# cust = cust.dropna(how='any') # null이 하나라도 있으면 그 행 삭제
# cust
cust = cust.dropna(how='all') # 전체행이 null일 경우만 그 행 삭제
cust


# cust[['npay', 'stop', 'termination']] = cust[['npay', 'stop', 'termination']].replace(np.NaN, 'N')
# cust[['service','avg_bill', 'A_bill', 'B_bill']] = cust[['service','avg_bill', 'A_bill', 'B_bill']].replace(np.NaN,0)
# cust.info()



```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>300.0000</td>
      <td>90.000000</td>
      <td>180.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4700.0000</td>
      <td>NaN</td>
      <td>4502.0000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>9929 rows × 10 columns</p>
</div>



# 참고사항
 * 특정문자열 찾기
 * null 값찾기


```python
# 특정문자열 찾기
cust[cust['npay'].isin(['N'])]
cust[cust['npay'].isin(['N','Y'])]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>F</td>
      <td>F</td>
      <td>61.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>13287.56670</td>
      <td>837.000000</td>
      <td>6682.5334</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>C</td>
      <td>M</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>2774.93326</td>
      <td>2522.666600</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>D</td>
      <td>F</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>54076.50000</td>
      <td>1742.000100</td>
      <td>5525.6000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29</th>
      <td>D</td>
      <td>M</td>
      <td>53.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>1821.60000</td>
      <td>1656.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>G</td>
      <td>M</td>
      <td>26.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>18373.66674</td>
      <td>2783.533400</td>
      <td>13919.8000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9901</th>
      <td>D</td>
      <td>M</td>
      <td>56.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>2590.33340</td>
      <td>NaN</td>
      <td>2365.5334</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9912</th>
      <td>G</td>
      <td>M</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>11479.16670</td>
      <td>1721.875005</td>
      <td>6138.9866</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9916</th>
      <td>G</td>
      <td>M</td>
      <td>45.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>32304.96670</td>
      <td>4845.745005</td>
      <td>15467.6193</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9921</th>
      <td>D</td>
      <td>M</td>
      <td>54.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>5198.06660</td>
      <td>NaN</td>
      <td>4760.8666</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>1296.09990</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1173 rows × 10 columns</p>
</div>




```python
# null 값 조회
cust[cust.isna().any(axis=True)]

# 특정 column null값 조회
cust[cust.termination.isna()]
# cust[(cust['termination'].isna())]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4700.0000</td>
      <td>NaN</td>
      <td>4502.0000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1361.7999</td>
      <td>1173.999900</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>D</td>
      <td>M</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13562.8000</td>
      <td>2222.000100</td>
      <td>3673.0000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>C</td>
      <td>M</td>
      <td>76.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1860.0000</td>
      <td>1716.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9927</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1396.2000</td>
      <td>1206.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>8711 rows × 10 columns</p>
</div>




```python
cust=cust_fix.copy()
cust[(cust['avg_bill']==0)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>683</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>



NA의 갯수에 따라 결측데이터를 판단하고자 한다면, thresh 파라미터를 사용하면 됩니다.    
NA가 아닌값이 n개 이상인 경우만 남겨라는 뜻으로 해석하면 됩니다.


```python
#임계치를 설정해서 제거하기
cust=cust_fix.copy()
cust=cust.dropna(thresh=10)
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8228 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8228 non-null   object 
     1   sex          8228 non-null   object 
     2   age          8228 non-null   float64
     3   service      8228 non-null   int64  
     4   stop         8228 non-null   object 
     5   npay         8228 non-null   object 
     6   avg_bill     8228 non-null   float64
     7   A_bill       8228 non-null   float64
     8   B_bill       8228 non-null   float64
     9   termination  8228 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 707.1+ KB


특정 열에 있는 NA만 참고하여 결측치를 제거하려면 Subset 파라미터를 사용하면 됩니다.


```python
# 특정열 안에서만 삭제하기|
cust=cust_fix.copy()

# cust[cust['class'].isna()] # 몇개인지 확인
cust=cust.dropna(subset=['class']) # class에서 NaN있는것만 삭제
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8529 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8529 non-null   object 
     1   sex          8236 non-null   object 
     2   age          8228 non-null   float64
     3   service      8529 non-null   int64  
     4   stop         8529 non-null   object 
     5   npay         8529 non-null   object 
     6   avg_bill     8529 non-null   float64
     7   A_bill       8529 non-null   float64
     8   B_bill       8529 non-null   float64
     9   termination  8529 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 733.0+ KB


<br>

## [실습1] 수업용 데이터 결측치 처리 하기
수업용 데이터 cust를 만들어 주세요.   
age를 제외한 모든 연속형 변수의 결측치를 0으로 바꾼 후, 결측치가 1개라도 있는 데이터는 제거 해주세요.    


```python
#문제를 풀어 보세요.
# 1. 수업용 cust 데이터 만들기
cust=cust_fix.copy()

# 임의로 결측치 만들다
for i in range(10,20):
    # cust['A_bill'].loc[i] = np.NaN
    cust.loc[i, 'A_bill'] = np.NaN
    
    
cust.head(20)

# 결측치 조회
cust[cust['service'].isna() | cust['A_bill'].isna() | cust['B_bill'].isna()]





```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2857.29990</td>
      <td>NaN</td>
      <td>1714.37994</td>
      <td>N</td>
    </tr>
    <tr>
      <th>11</th>
      <td>F</td>
      <td>M</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>11472.33340</td>
      <td>NaN</td>
      <td>8910.13340</td>
      <td>N</td>
    </tr>
    <tr>
      <th>12</th>
      <td>F</td>
      <td>F</td>
      <td>61.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>13287.56670</td>
      <td>NaN</td>
      <td>6682.53340</td>
      <td>N</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>F</td>
      <td>27.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>8811.51315</td>
      <td>NaN</td>
      <td>7118.46660</td>
      <td>N</td>
    </tr>
    <tr>
      <th>14</th>
      <td>D</td>
      <td>F</td>
      <td>42.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>7136.86660</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>15</th>
      <td>C</td>
      <td>M</td>
      <td>87.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>2774.93326</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>16</th>
      <td>E</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>12683.00011</td>
      <td>NaN</td>
      <td>9602.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>17</th>
      <td>D</td>
      <td>F</td>
      <td>87.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4852.80000</td>
      <td>NaN</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>18</th>
      <td>E</td>
      <td>M</td>
      <td>48.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>15259.40000</td>
      <td>NaN</td>
      <td>9155.64000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>19</th>
      <td>NaN</td>
      <td>F</td>
      <td>60.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>7135.11326</td>
      <td>NaN</td>
      <td>4005.46660</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치 0으로 치환
cust[['service','A_bill', 'B_bill']] = cust[['service','A_bill', 'B_bill']].fillna(0)

# 0으로 치환되었는지 확인
cust.head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.00000</td>
      <td>792.00000</td>
      <td>1584.00000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>300.00000</td>
      <td>90.00000</td>
      <td>180.00000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.00000</td>
      <td>2526.00000</td>
      <td>6983.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.73340</td>
      <td>2331.71001</td>
      <td>6750.46660</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.00000</td>
      <td>0.00000</td>
      <td>4502.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.79990</td>
      <td>1173.99990</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>6</th>
      <td>D</td>
      <td>M</td>
      <td>22.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13562.80000</td>
      <td>2222.00010</td>
      <td>3673.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>7</th>
      <td>D</td>
      <td>F</td>
      <td>65.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4953.93340</td>
      <td>987.00000</td>
      <td>2700.39990</td>
      <td>N</td>
    </tr>
    <tr>
      <th>8</th>
      <td>D</td>
      <td>M</td>
      <td>60.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>5503.00000</td>
      <td>2093.00010</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>9</th>
      <td>C</td>
      <td>F</td>
      <td>67.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1349.70000</td>
      <td>1227.00000</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>10</th>
      <td>C</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2857.29990</td>
      <td>0.00000</td>
      <td>1714.37994</td>
      <td>N</td>
    </tr>
    <tr>
      <th>11</th>
      <td>F</td>
      <td>M</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>11472.33340</td>
      <td>0.00000</td>
      <td>8910.13340</td>
      <td>N</td>
    </tr>
    <tr>
      <th>12</th>
      <td>F</td>
      <td>F</td>
      <td>61.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>13287.56670</td>
      <td>0.00000</td>
      <td>6682.53340</td>
      <td>N</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>F</td>
      <td>27.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>8811.51315</td>
      <td>0.00000</td>
      <td>7118.46660</td>
      <td>N</td>
    </tr>
    <tr>
      <th>14</th>
      <td>D</td>
      <td>F</td>
      <td>42.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>7136.86660</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>15</th>
      <td>C</td>
      <td>M</td>
      <td>87.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>2774.93326</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>16</th>
      <td>E</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>12683.00011</td>
      <td>0.00000</td>
      <td>9602.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>17</th>
      <td>D</td>
      <td>F</td>
      <td>87.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4852.80000</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>18</th>
      <td>E</td>
      <td>M</td>
      <td>48.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>15259.40000</td>
      <td>0.00000</td>
      <td>9155.64000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>19</th>
      <td>NaN</td>
      <td>F</td>
      <td>60.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>7135.11326</td>
      <td>0.00000</td>
      <td>4005.46660</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치 1개 이상 모두 제거
cust = cust.dropna()
cust.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8228 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8228 non-null   object 
     1   sex          8228 non-null   object 
     2   age          8228 non-null   float64
     3   service      8228 non-null   int64  
     4   stop         8228 non-null   object 
     5   npay         8228 non-null   object 
     6   avg_bill     8228 non-null   float64
     7   A_bill       8228 non-null   float64
     8   B_bill       8228 non-null   float64
     9   termination  8228 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 707.1+ KB


<br><br>
## 3. 이상치 처리하기
### <b>범주형 데이터 이상치 처리 하기</b>
범주형 데이터의 경우 value_counts 메소드를 사용하면, 값의 분포와 함께 Trash 값이 있는지도 확인 가능합니다.


```python
#범주형 데아터의 값 분포 확인하기

print(cust['sex'].value_counts())
print(cust['class'].value_counts())
print(cust['npay'].value_counts())
```

    M    4432
    F    3796
    Name: sex, dtype: int64
    D    2181
    G    2038
    C    1913
    E    1244
    F     711
    H     141
    Name: class, dtype: int64
    N    7259
    Y     969
    Name: npay, dtype: int64


Class의 값에는 'C, D, E, F, G, H'가 들어있는것을 확인할수 있습니다.    
실제로 그렇지는 않지만 'H'가 실제로는 존재하지 않는 값이라고 가정해 봅시다.    
이상치를 처리하는 방법은 제거하기와 변경하기가 있습니다.


```python
#이상치 제거하기
# cust_data=cust[(cust['class']!='H')]
# print(cust_data['class'].value_counts())

cust_data = cust.copy()

# cust.info()

# # 1. NaN으로 만들어서 제거하는 방법
# # cust['class'].replace('H', np.NaN, inplace=True)
# cust['class'] = cust['class'].replace('H', np.NaN)
# cust = cust.dropna()
# cust['class'].isnull().sum()    # NaN 개수확인 조회 Null개수, 널개수 널값개수 확인

# H만 제외한 나머지를 저장하는 방법
cust_data = cust[(cust['class']!='H')]
cust_data['class'].value_counts()


# cust_data = cust[cust['class'] != 'H']
# print(cust_data['class'].value_counts())
```




    D    2181
    G    2038
    C    1913
    E    1244
    F     711
    Name: class, dtype: int64




```python
#이상치 변경하기
cust_data = cust.copy()
print(cust_data['class'].value_counts())
cust_data['class'] = cust_data['class'].replace('H','F')
print(cust_data['class'].value_counts())







# [[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[

# cust_data=cust.copy()
# cust_data['class']=cust_data['class'].replace('H','F')
# print(cust_data['class'].value_counts())
```

    D    2181
    G    2038
    C    1913
    E    1244
    F     711
    H     141
    Name: class, dtype: int64
    D    2181
    G    2038
    C    1913
    E    1244
    F     852
    Name: class, dtype: int64


### <b>수치형 데이터 이상치 처리 하기</b>
describe 함수를 사용해서 수치형 변수의 기술 통계를 확인 할 수 있습니다.


```python
cust.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>47.879801</td>
      <td>1.226544</td>
      <td>10356.605452</td>
      <td>1762.926428</td>
      <td>5630.461347</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.255090</td>
      <td>0.800793</td>
      <td>8394.568408</td>
      <td>2600.242733</td>
      <td>4380.126308</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>1.000000</td>
      <td>4725.601635</td>
      <td>382.601250</td>
      <td>2385.362475</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9396.623330</td>
      <td>1664.340052</td>
      <td>5404.765400</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.000000</td>
      <td>1.000000</td>
      <td>14322.583350</td>
      <td>2325.000000</td>
      <td>8434.983300</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>144739.686600</td>
      <td>131581.533300</td>
      <td>65836.558700</td>
    </tr>
  </tbody>
</table>
</div>



Q1와 Q3가 거리의 1.5배가 넘어가는 값을 Outlier 라고 합니다.    
이 값들은 이상치로써 일반적으로 제거 또는 변경하여 데이터를 분석,학습 합니다.    
단, 이상치 분석시에는 제거하지 않습니다.    

### 이상치를 제거하는 함수


```python
#이상치를 제거하는 함수 만들기
def removeOutliers(x, column):
    # Q1, Q3구하기
    q1 = x[column].quantile(0.25)
    q3 = x[column].quantile(0.75)
    
    # 1.5 * IQR(Q3 - Q1)
    iqr = 1.5 * (q3 - q1)
    
    # 이상치를 제거
    y=x[(x[column] < (q3 + iqr)) & (x[column] > (q1 - iqr))]
    
    return(y)
```


```python
#연속형 데이터의 이상치 제거하기
cust_data=removeOutliers(cust, 'avg_bill')
cust_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8066.000000</td>
      <td>8066.000000</td>
      <td>8066.000000</td>
      <td>8066.000000</td>
      <td>8066.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>48.084676</td>
      <td>1.217208</td>
      <td>9583.537798</td>
      <td>1651.289810</td>
      <td>5474.779413</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.303865</td>
      <td>0.788121</td>
      <td>5823.988384</td>
      <td>1591.235661</td>
      <td>4086.681516</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>33.000000</td>
      <td>1.000000</td>
      <td>4649.192605</td>
      <td>353.450100</td>
      <td>2302.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9199.100000</td>
      <td>1652.799900</td>
      <td>5305.609300</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>62.000000</td>
      <td>1.000000</td>
      <td>14001.666650</td>
      <td>2294.950005</td>
      <td>8281.073320</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>28649.300000</td>
      <td>19698.533200</td>
      <td>19965.376000</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust_data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8066 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8066 non-null   object 
     1   sex          8066 non-null   object 
     2   age          8066 non-null   float64
     3   service      8066 non-null   int64  
     4   stop         8066 non-null   object 
     5   npay         8066 non-null   object 
     6   avg_bill     8066 non-null   float64
     7   A_bill       8066 non-null   float64
     8   B_bill       8066 non-null   float64
     9   termination  8066 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 693.2+ KB



```python
# 동일한 함수로 나머지 연속형 변수에 대해서도 이상치를 처리
cust_data=removeOutliers(cust_data, 'A_bill')
cust_data=removeOutliers(cust_data, 'B_bill')
cust_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7814.000000</td>
      <td>7814.000000</td>
      <td>7814.000000</td>
      <td>7814.000000</td>
      <td>7814.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>48.083184</td>
      <td>1.193627</td>
      <td>9386.907925</td>
      <td>1481.914238</td>
      <td>5440.968338</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.381304</td>
      <td>0.722465</td>
      <td>5724.551857</td>
      <td>1091.727376</td>
      <td>3970.954052</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>33.000000</td>
      <td>1.000000</td>
      <td>4435.200028</td>
      <td>340.049925</td>
      <td>2384.754225</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9028.103480</td>
      <td>1612.377502</td>
      <td>5308.100000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>62.000000</td>
      <td>1.000000</td>
      <td>13766.816700</td>
      <td>2236.472493</td>
      <td>8204.865050</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>9.000000</td>
      <td>28649.300000</td>
      <td>5190.533400</td>
      <td>17034.600000</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust_data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 7814 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        7814 non-null   object 
     1   sex          7814 non-null   object 
     2   age          7814 non-null   float64
     3   service      7814 non-null   int64  
     4   stop         7814 non-null   object 
     5   npay         7814 non-null   object 
     6   avg_bill     7814 non-null   float64
     7   A_bill       7814 non-null   float64
     8   B_bill       7814 non-null   float64
     9   termination  7814 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 671.5+ KB


### 이상치를 변경하는 함수


```python
# 이상치를 변경하는 함수 만들기
def changeOutliers(data, column):
    x=data.copy()
    # Q1, Q3구하기
    q1 = x[column].quantile(0.25)
    q3 = x[column].quantile(0.75)
    
    # 1.5 * IQR(Q3 - Q1)
    iqr = 1.5 * (q3 - q1)
    
    #이상치 대체값 설정하기
    Min = 0
    if (q1 - iqr) > 0 : Min=(q1 - iqr)
        
    Max = q3 + iqr
    
    # 이상치를 변경
    # X의 값을 직졉 변경해도 되지만 Pyhon Warning이 나오기 떄문에 인덱스를 이용
    x.loc[(x[column] > Max), column]= Max
    x.loc[(x[column] < Min), column]= Min
    
    return(x)
```


```python
#연속형 데이터의 이상치 변경하기
cust_data=changeOutliers(cust, 'avg_bill')
cust_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>47.879801</td>
      <td>1.226544</td>
      <td>9960.274786</td>
      <td>1762.926428</td>
      <td>5630.461347</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.255090</td>
      <td>0.800793</td>
      <td>6349.688567</td>
      <td>2600.242733</td>
      <td>4380.126308</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>1.000000</td>
      <td>4725.601635</td>
      <td>382.601250</td>
      <td>2385.362475</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9396.623330</td>
      <td>1664.340052</td>
      <td>5404.765400</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.000000</td>
      <td>1.000000</td>
      <td>14322.583350</td>
      <td>2325.000000</td>
      <td>8434.983300</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>28718.055922</td>
      <td>131581.533300</td>
      <td>65836.558700</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>47.879801</td>
      <td>1.226544</td>
      <td>10356.605452</td>
      <td>1762.926428</td>
      <td>5630.461347</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.255090</td>
      <td>0.800793</td>
      <td>8394.568408</td>
      <td>2600.242733</td>
      <td>4380.126308</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>1.000000</td>
      <td>4725.601635</td>
      <td>382.601250</td>
      <td>2385.362475</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9396.623330</td>
      <td>1664.340052</td>
      <td>5404.765400</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.000000</td>
      <td>1.000000</td>
      <td>14322.583350</td>
      <td>2325.000000</td>
      <td>8434.983300</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>144739.686600</td>
      <td>131581.533300</td>
      <td>65836.558700</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 동일한 함수로 나머지 연속형 변수에 대해서도 이상치를 처리
cust_data=changeOutliers(cust_data, 'A_bill')
cust_data=changeOutliers(cust_data, 'B_bill')
cust_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>47.879801</td>
      <td>1.226544</td>
      <td>9960.274786</td>
      <td>1616.826149</td>
      <td>5590.639102</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.255090</td>
      <td>0.800793</td>
      <td>6349.688567</td>
      <td>1280.921365</td>
      <td>4165.266250</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>1.000000</td>
      <td>4725.601635</td>
      <td>382.601250</td>
      <td>2385.362475</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9396.623330</td>
      <td>1664.340052</td>
      <td>5404.765400</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.000000</td>
      <td>1.000000</td>
      <td>14322.583350</td>
      <td>2325.000000</td>
      <td>8434.983300</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>28718.055922</td>
      <td>5238.598125</td>
      <td>17509.414538</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust_data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8228 entries, 0 to 9929
    Data columns (total 10 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8228 non-null   object 
     1   sex          8228 non-null   object 
     2   age          8228 non-null   float64
     3   service      8228 non-null   int64  
     4   stop         8228 non-null   object 
     5   npay         8228 non-null   object 
     6   avg_bill     8228 non-null   float64
     7   A_bill       8228 non-null   float64
     8   B_bill       8228 non-null   float64
     9   termination  8228 non-null   object 
    dtypes: float64(4), int64(1), object(5)
    memory usage: 707.1+ KB


<br><br>

## 4. Feature Engineering
초기 데이터로부터 특징을 가공하고 생산하여 입력 데이터를 생성하는 과정을 Feature Engineering이라고 합니다.    
Feature Engineering을 통해 AI가 학습하기 좋은 형태로 데이터를 만들거나, 새로운 입력 데이터를 생성 할수 있습니다.    
이때 데이터를 수정하지 않도록 주의 합니다.    


```python
cust_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.99990</td>
      <td>0.0000</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>



### <b>Binning</b>
Binning은 단어 뜻 그대로 자료를 일정한 규격의 통에 넣는것 입니다.    
만약 관측치가 연속형이면서 범위가 너무 다양할 경우, 적절히 그룹을 지어주면 데이터를 이해하기가 더 쉬워질수 있기에 사용합니다.    
즉, 연속형 변수를 범주형 변수로 만드는 방법이라고 보시면 됩니다.


```python
# age를 활용하여 나이대("by_age")  Feature 만들기
cust_data['by_age']=cust_data['age']//10*10  ## //는 내림 나눗셈으로  정수형의 몫만 취한다
cust_data.info()
cust_data=cust_data.astype({'age': int, 'by_age':int})
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 8228 entries, 0 to 9929
    Data columns (total 11 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   class        8228 non-null   object 
     1   sex          8228 non-null   object 
     2   age          8228 non-null   float64
     3   service      8228 non-null   int64  
     4   stop         8228 non-null   object 
     5   npay         8228 non-null   object 
     6   avg_bill     8228 non-null   float64
     7   A_bill       8228 non-null   float64
     8   B_bill       8228 non-null   float64
     9   termination  8228 non-null   object 
     10  by_age       8228 non-null   float64
    dtypes: float64(5), int64(1), object(5)
    memory usage: 771.4+ KB



```python
cust_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
      <th>by_age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
      <td>10</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.99990</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>



#### <b>cut</b>
Cut 함수를 사용하면 구간을 지정해서 쉽게 범주화 할 수 있습니다.    
Bins 구간 사이의 값을 범주화 하여 Label에 지정된 카테고리명을 사용합니다.




```python
q1=cust_data['avg_bill'].quantile(0.25)
q3=cust_data['avg_bill'].quantile(0.75)
print(q1,q3)
```

    4725.601635 14322.583349999999



```python
cust_data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>service</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>by_age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>47.879801</td>
      <td>1.226544</td>
      <td>9960.274786</td>
      <td>1616.826149</td>
      <td>5590.639102</td>
      <td>43.355615</td>
    </tr>
    <tr>
      <th>std</th>
      <td>19.255090</td>
      <td>0.800793</td>
      <td>6349.688567</td>
      <td>1280.921365</td>
      <td>4165.266250</td>
      <td>19.444865</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>299.900100</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.000000</td>
      <td>1.000000</td>
      <td>4725.601635</td>
      <td>382.601250</td>
      <td>2385.362475</td>
      <td>30.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>49.000000</td>
      <td>1.000000</td>
      <td>9396.623330</td>
      <td>1664.340052</td>
      <td>5404.765400</td>
      <td>40.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>61.000000</td>
      <td>1.000000</td>
      <td>14322.583350</td>
      <td>2325.000000</td>
      <td>8434.983300</td>
      <td>60.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>104.000000</td>
      <td>14.000000</td>
      <td>28718.055922</td>
      <td>5238.598125</td>
      <td>17509.414538</td>
      <td>100.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
#cut 메소드를 활용하여 요금을 3개 구간으로 나누기
cust_data['bill_rating'] = pd.cut(cust_data['avg_bill'], 
                                  bins = [0, q1, q3, cust['avg_bill'].max()],
                                  labels = ['row', 'middle','high'])
cust_data.head()
# cust_data['bill_rating'] = pd.cut(cust_data["avg_bill"], bins=[0,q1,q3,cust_data["avg_bill"].max()] , labels=['low', 'mid','high'])
# cust_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
      <th>by_age</th>
      <th>bill_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.00000</td>
      <td>1584.0000</td>
      <td>Y</td>
      <td>20</td>
      <td>row</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.00000</td>
      <td>6983.0000</td>
      <td>N</td>
      <td>20</td>
      <td>high</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.71001</td>
      <td>6750.4666</td>
      <td>N</td>
      <td>30</td>
      <td>high</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.00000</td>
      <td>4502.0000</td>
      <td>N</td>
      <td>10</td>
      <td>row</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.99990</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
      <td>row</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(cust_data['bill_rating'].value_counts())
```

    middle    4114
    high      2057
    row       2057
    Name: bill_rating, dtype: int64


#### qcut
cut비슷하지만 같은 크기로 구간을 나누어 범주형 변수로 만듭니다


```python
#qcut 메소드를 활용하여 요금을 동일 비율로 3개 구간으로 나누기
cust_data['bill_rating'] = pd.qcut(cust_data['avg_bill'],3,labels=["row", "meddle", "high"])
print(cust_data.head())
# cust_data['bill_rating'].value_counts()

# cust_data['bill_rating'] = pd.qcut(cust_data["avg_bill"], 3 , labels=['low', 'mid','high'])
# cust_data.head()
```

      class sex  age  service stop npay    avg_bill      A_bill     B_bill  \
    0     C   F   28        0    N    N   2640.0000   792.00000  1584.0000   
    2     E   F   24        1    N    N  16840.0000  2526.00000  6983.0000   
    3     F   F   32        1    N    N  15544.7334  2331.71001  6750.4666   
    4     D   M   18        1    N    N   4700.0000     0.00000  4502.0000   
    5     C   F   78        1    N    N   1361.7999  1173.99990     0.0000   
    
      termination  by_age bill_rating  
    0           Y      20         row  
    2           N      20        high  
    3           N      30        high  
    4           N      10         row  
    5           N      70         row  



```python
print(cust_data['bill_rating'].value_counts())
```

    row       2744
    high      2743
    meddle    2741
    Name: bill_rating, dtype: int64


### <b>Scaling
각 컬럼에 들어있는 데이터의 상대적 크기에 따라 분석 결과나 모델링 결과가 달라질수 있습니다.    
0 ~ 1000까지의 값을 가지는 변수 A와 0 ~ 10까지의 값을 가지는 변수 B를 가지고 분석을 수행하면 상대적으로 큰 숫자를 가지는 A변수의 영향이 더 크게 반영 됩니다.    
따라서, 숫자데이터는 상대적 크기 차이를 제거할 필요가 있고, 이를 scaling이라고 합니다.    

#### Standardization
정규 분포를 평균이 0 이고 분산이 1 인  표준 정규 분포로 변환합니다. 


```python
# cust_data_num = cust_data[['avg_bill', 'A_bill', 'B_bill']]
# cust_data_num = cust_data[['avg_bill', 'A_bill', 'B_bill']]

# cust_data_num = (cust_data_num - cust_data_num.mean()) / cust_data_num.std()
# cust_data_num.head()
# cust_data_num.describe()

cust_data_num = cust_data[['avg_bill', 'A_bill', 'B_bill']]
#표준화
Standardization_df = (cust_data_num - cust_data_num.mean())/cust_data_num.std()
Standardization_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.152856</td>
      <td>-0.643932</td>
      <td>-0.961917</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.083474</td>
      <td>0.709781</td>
      <td>0.334279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.879485</td>
      <td>0.558101</td>
      <td>0.278452</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.828430</td>
      <td>-1.262237</td>
      <td>-0.261361</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1.354157</td>
      <td>-0.345709</td>
      <td>-1.342204</td>
    </tr>
  </tbody>
</table>
</div>




```python
Standardization_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8.228000e+03</td>
      <td>8.228000e+03</td>
      <td>8.228000e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-4.388538e-15</td>
      <td>1.225698e-14</td>
      <td>-9.695696e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.521393e+00</td>
      <td>-1.262237e+00</td>
      <td>-1.342204e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-8.243984e-01</td>
      <td>-9.635446e-01</td>
      <td>-7.695250e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-8.876836e-02</td>
      <td>3.709354e-02</td>
      <td>-4.462469e-02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.870114e-01</td>
      <td>5.528629e-01</td>
      <td>6.828721e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.954126e+00</td>
      <td>2.827474e+00</td>
      <td>2.861468e+00</td>
    </tr>
  </tbody>
</table>
</div>



####  Normalization
값들을 모두 0과 1사이의 값으로 변환합니다. (0 ~ 1)


```python
#사이킷런 패키지의 MinMaxScaler를 이용하여  Scaling 하기
from sklearn.preprocessing import MinMaxScaler
scaler=MinMaxScaler()
# normalization_df=cust_data_num.copy()
normalization_df = cust_data[['avg_bill', 'A_bill', 'B_bill']].copy()  # copy를 사용해야 함을 유의
normalization_df[:]=scaler.fit_transform(normalization_df[:])   
normalization_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.082345</td>
      <td>0.151185</td>
      <td>0.090466</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.582026</td>
      <td>0.482190</td>
      <td>0.398814</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.536447</td>
      <td>0.445102</td>
      <td>0.385534</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.154834</td>
      <td>0.000000</td>
      <td>0.257119</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.037367</td>
      <td>0.224106</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
normalization_df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8228.000000</td>
      <td>8228.000000</td>
      <td>8228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.339937</td>
      <td>0.308637</td>
      <td>0.319293</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.223438</td>
      <td>0.244516</td>
      <td>0.237887</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.155735</td>
      <td>0.073035</td>
      <td>0.136233</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.320103</td>
      <td>0.317707</td>
      <td>0.308678</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.493441</td>
      <td>0.443821</td>
      <td>0.481740</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
#MinMaxScaler 함수 구현하기 (위에줄이랑 동일한 결과 출력)
normalization_df = (cust_data_num - cust_data_num.min())/(cust_data_num.max()-cust_data_num.min())
normalization_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.082345</td>
      <td>0.151185</td>
      <td>0.090466</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.582026</td>
      <td>0.482190</td>
      <td>0.398814</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.536447</td>
      <td>0.445102</td>
      <td>0.385534</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.154834</td>
      <td>0.000000</td>
      <td>0.257119</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.037367</td>
      <td>0.224106</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>



### <b>One-Hot Encording

원-핫 인코딩은 간단히 말해 한 개의 요소는 True, 나머지 요소는 False로 만들어 주는 기법입니다.    
기계 학습의 주요 문제 중 하나는 많은 알고리즘이 범주 형 데이터를 입력값으로 수용하지 않는다는 점인데, 이를 One-Hot Encording을 통해 해결 할 수 있습니다.    
정수 치환으로 해결 할 수도 있지만 이럴 경우 성능이 저하되거나 예상치 못한 결과가 발생할 수 있습니다.


```python
cust_data

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
      <th>by_age</th>
      <th>bill_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
      <td>20</td>
      <td>row</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
      <td>20</td>
      <td>high</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
      <td>30</td>
      <td>high</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
      <td>10</td>
      <td>row</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.999900</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
      <td>row</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>C</td>
      <td>M</td>
      <td>76</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1860.0000</td>
      <td>1716.000000</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
      <td>10</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
      <td>10</td>
      <td>high</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
      <td>40</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
      <td>50</td>
      <td>row</td>
    </tr>
  </tbody>
</table>
<p>8228 rows × 12 columns</p>
</div>




```python
#pandas에서는 get_dummies함수를 사용하면 쉽게 One-Hot Encording이 가능
pd.get_dummies(cust_data['class'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8228 rows × 6 columns</p>
</div>




```python
#columns를 사용해서 기존 테이블에 One-Hot Encording으로 치환된 변수 생성하기
cust_data_end=pd.get_dummies(cust_data, columns=['class'])
cust_data_end
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
      <th>by_age</th>
      <th>bill_rating</th>
      <th>class_C</th>
      <th>class_D</th>
      <th>class_E</th>
      <th>class_F</th>
      <th>class_G</th>
      <th>class_H</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>28</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
      <td>20</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>24</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
      <td>20</td>
      <td>high</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>32</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
      <td>30</td>
      <td>high</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M</td>
      <td>18</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
      <td>10</td>
      <td>row</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F</td>
      <td>78</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.999900</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>M</td>
      <td>76</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1860.0000</td>
      <td>1716.000000</td>
      <td>0.0000</td>
      <td>N</td>
      <td>70</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>F</td>
      <td>15</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
      <td>10</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>M</td>
      <td>12</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
      <td>10</td>
      <td>high</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>F</td>
      <td>40</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
      <td>40</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>F</td>
      <td>59</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
      <td>50</td>
      <td>row</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8228 rows × 17 columns</p>
</div>



<br>

## [실습2] 수업용 데이터 이상치 처리와 Feature Engineering 하기
cust 데이터의 이상치는 제거하고, 나이는 5단위로 범주화, 평균 요금은 5개 구간으로 나누어 새로운 변수를 만들어 데이터를 저장 해보세요.

* 이상치 : InterQuartile Range의 1.5배가 넘는 수 (처리 대상 Feature : avg_bill, A_bill, B_bill)
* by_age : 나이는 0 ~ 4세는 0/ 5 ~ 9세는 5 / 10 ~ 14세는 10으로 5단위 범주화
* bill_rating : 전체 평균 요금을 균등비율로 low / lowmid / mid / midhigh / high 5단계로 구분


```python
#문제를 풀어 보세요.
cust2 = cust.copy()
cust2

def removeOutliers(x, column):
    # Q1, Q3구하기
    q1 = x[column].quantile(0.25)
    q3 = x[column].quantile(0.75)
    
    # 1.5 * IQR(Q3 - Q1)
    iqr = 1.5 * (q3 - q1)
    
    # 이상치를 제거
    y=x[(x[column] < (q3 + iqr)) & (x[column] > (q1 - iqr))]
    
    return(y)
	




# 1. 이상치 제거 처리
# cust2['avg_bill'].Inter
cust_data2 = removeOutliers(cust_data2, 'avg_bill')
cust_data2 = removeOutliers(cust_data2, 'A_bill')
cust_data2 = removeOutliers(cust_data2, 'B_bill')
cust_data2.describe()


# 2. 나이 구가별 범주화
# 5로 나눈 몫의 * 5
cust_data2['by_age'] = cust_data2['age'] // 5 * 5

cust_data2 = cust_data2.astype({'by_age': 'int'})
cust_data2.info()


# 3. bill_rating : 전체 평균 요금을 균등비율로 low / lowmid / mid / midhigh / high 5단계로 구분


q1=cust_data2['avg_bill'].quantile(0.2)
q2=cust_data2['avg_bill'].quantile(0.4)
q3=cust_data2['avg_bill'].quantile(0.6)
q4=cust_data2['avg_bill'].quantile(0.8)
# print(q1,q2,q3,q4)

cust_data2['bill_rating'] = pd.cut(cust_data2['avg_bill'], 
                                  bins = [0, q1, q2, q3, q4, cust['avg_bill'].max()],
                                  labels = ['row', 'lowmid','mid', 'midhigh', 'high'])
# cust_data2['bill_rating'].value_counts()
cust_data2
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 7788 entries, 0 to 9929
    Data columns (total 12 columns):
     #   Column       Non-Null Count  Dtype   
    ---  ------       --------------  -----   
     0   class        7788 non-null   object  
     1   sex          7788 non-null   object  
     2   age          7788 non-null   float64 
     3   service      7788 non-null   int64   
     4   stop         7788 non-null   object  
     5   npay         7788 non-null   object  
     6   avg_bill     7788 non-null   float64 
     7   A_bill       7788 non-null   float64 
     8   B_bill       7788 non-null   float64 
     9   termination  7788 non-null   object  
     10  by_age       7788 non-null   int64   
     11  bill_rating  7788 non-null   category
    dtypes: category(1), float64(4), int64(2), object(5)
    memory usage: 737.9+ KB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>sex</th>
      <th>age</th>
      <th>service</th>
      <th>stop</th>
      <th>npay</th>
      <th>avg_bill</th>
      <th>A_bill</th>
      <th>B_bill</th>
      <th>termination</th>
      <th>by_age</th>
      <th>bill_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C</td>
      <td>F</td>
      <td>28.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>2640.0000</td>
      <td>792.000000</td>
      <td>1584.0000</td>
      <td>Y</td>
      <td>25</td>
      <td>row</td>
    </tr>
    <tr>
      <th>2</th>
      <td>E</td>
      <td>F</td>
      <td>24.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>16840.0000</td>
      <td>2526.000000</td>
      <td>6983.0000</td>
      <td>N</td>
      <td>20</td>
      <td>high</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>F</td>
      <td>32.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>15544.7334</td>
      <td>2331.710010</td>
      <td>6750.4666</td>
      <td>N</td>
      <td>30</td>
      <td>high</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D</td>
      <td>M</td>
      <td>18.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>4700.0000</td>
      <td>0.000000</td>
      <td>4502.0000</td>
      <td>N</td>
      <td>15</td>
      <td>lowmid</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>F</td>
      <td>78.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1361.7999</td>
      <td>1173.999900</td>
      <td>0.0000</td>
      <td>N</td>
      <td>75</td>
      <td>row</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9923</th>
      <td>C</td>
      <td>M</td>
      <td>76.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>1860.0000</td>
      <td>1716.000000</td>
      <td>0.0000</td>
      <td>N</td>
      <td>75</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9925</th>
      <td>C</td>
      <td>F</td>
      <td>15.0</td>
      <td>1</td>
      <td>N</td>
      <td>Y</td>
      <td>1296.0999</td>
      <td>194.414985</td>
      <td>643.1001</td>
      <td>N</td>
      <td>15</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9926</th>
      <td>G</td>
      <td>M</td>
      <td>12.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>13799.6666</td>
      <td>2069.949990</td>
      <td>10605.9266</td>
      <td>N</td>
      <td>10</td>
      <td>midhigh</td>
    </tr>
    <tr>
      <th>9928</th>
      <td>C</td>
      <td>F</td>
      <td>40.0</td>
      <td>0</td>
      <td>N</td>
      <td>N</td>
      <td>3140.0000</td>
      <td>942.000000</td>
      <td>1884.0000</td>
      <td>Y</td>
      <td>40</td>
      <td>row</td>
    </tr>
    <tr>
      <th>9929</th>
      <td>C</td>
      <td>F</td>
      <td>59.0</td>
      <td>1</td>
      <td>N</td>
      <td>N</td>
      <td>2436.9000</td>
      <td>365.535000</td>
      <td>1839.9000</td>
      <td>N</td>
      <td>55</td>
      <td>row</td>
    </tr>
  </tbody>
</table>
<p>7788 rows × 12 columns</p>
</div>




```python
#직접 전처리 완료한 데이터 CSV파일로 저장 
#다음 실습에서 만든 파일을 사용하니, 전처리 후 꼭 아래 코드를 실행해 주세요. 
cust_data2.to_csv('cust_data2(연습과제2).csv', index=False)
```
