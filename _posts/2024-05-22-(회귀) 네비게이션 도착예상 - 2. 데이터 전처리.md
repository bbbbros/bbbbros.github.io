# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°ë¶€í„°

### ê°€. ë¼ì´ë¸ŒëŸ¬ë¦¬ Import


```python
import pandas as pd
import numpy as np
```

### ë‚˜. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

### ë§Œì•½ì— Train/Evaluation ë°ì´í„°ë¥¼ ë”°ë¡œ ì „ì²˜ë¦¬ í•œë‹¤ë©´?
* ì „ì²˜ë¦¬ ê¸°ì¤€(íŠ¹íˆ ì •ê·œí™” ì‘ì—… ì‹œ)ì´ ë‹¬ë¼ì ¸ì„œ ëª¨ë¸ì˜ ì„±ëŠ¥ì— ì•…ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŒ


```python

```


```python
# ë°ì´í„° ì…‹ ë¡œë”©
df = pd.read_csv("onenavi_train.csv", sep = "|")
df_eval = pd.read_csv("onenavi_evaluation.csv", sep = "|")
# í•™ìŠµ/í‰ê°€ ë°ì´í„°ì˜ ì „ì²˜ë¦¬ ê¸°ì¤€ì„ í†µì¼í•˜ê¸°ìœ„í•´ ë°ì´í„° í•©ë³¸
df_total=pd.concat([df,df_eval],ignore_index=True)
# ì¶”ê°€ ë°ì´í„° ì…‹ ë¡œë”©
# df_pnu = pd.read_csv("onenavi_pnu.csv",sep="|") # ì£¼ì†Œ(ì‹œë„/ì‹œêµ°êµ¬ ì •ë³´)
# df_signal = pd.read_csv("onenavi_signal.csv",sep="|") # ê²½ë¡œì˜ ì‹ í˜¸ë“± ê°¯ìˆ˜
# # ë°ì´í„° í•©ì¹˜ê¸°
# df_total=pd.merge(df_total,df_pnu , on="RID")
# df_total=pd.merge(df_total,df_signal , on="RID")
# df_total
```

---

# 1. ì´ìƒì¹˜/ê²°ì¸¡ì¹˜ ì²˜ë¦¬
## Trashë¥¼ íŒë³„í•˜ëŠ” ëŠ¥ë ¥ì€ ì¢‹ì€ AIëª¨ë¸ì„ ë§Œë“œëŠ” ë° ìˆì–´ í•µì‹¬ì…ë‹ˆë‹¤.
+ KeyPoint : ë°ì´í„°ì˜ í˜•íƒœë¥¼ ì‚´í´ë³´ê³  ë¶ˆí•„ìš”í•œ ë°ì´í„°ë¥¼ ì •ì œí•  ìˆ˜ ìˆë‹¤.

[ì°¸ê³ ] ê³µì‹ Document
+ fillna(https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html)
+ dropna(https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html)

### ê°€. ê²°ì¸¡ì¹˜ ì²˜ë¦¬

### ì‹¤ìŠµ1. <u>df_totalì˜ ê²°ì¸¡ì¹˜ë¥¼ í™•ì¸í•˜ê³  ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•œë‹¤ë©´ ì œê±°í•´ì£¼ì„¸ìš”.</u>


```python
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 5.9+ MB



```python
# ì•„ë˜ì— ì‹¤ìŠµì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.(Hint : dataframedf_total.isnull().sum() // dropna(), fillna())
print(df_total.isna().sum())

# NULLê°’ ì‚­ì œ
df_total = df_total.dropna()

df_total.info()
```

    RID                   0
    TIME_DEPARTUREDATE    0
    TIME_ARRIVEDATE       0
    A_DISTANCE            0
    ET                    0
    ETA                   0
    ETAA                  0
    dtype: int64
    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB


### ë‚˜. ì´ìƒì¹˜ ì²˜ë¦¬
#### ì´ìƒì¹˜(Outlier)ëŠ” ì „ì ìœ¼ë¡œ ì—°êµ¬ì í˜¹ì€ ê°œë°œìê°€ íŒë‹¨ì„ í•´ì•¼í•œë‹¤. ìì„¸íˆ ì‚´í´ë³´ì§€ì•Šìœ¼ë©´ ë†“ì¹˜ê¸° ì‰½ìƒì´ë‹¤.
#### "ìì„¸íˆ ë³´ì•„ì•¼ ë“œëŸ¬ë‚œë‹¤. ì˜¤ë˜ ë³´ì•„ì•¼ ë„ì›€ì´ ëœë‹¤. Outlierê°€ ê·¸ë ‡ë‹¤."

### ì‹¤ìŠµ2. <u>ì‹œê°í™” ê¸°ë²• ë° ë°ì´í„° ë¶„í¬ë¥¼ í™•ì¸í•˜ê³  df_totalì˜ ì´ìƒì¹˜ë¥¼ ì „ì²˜ë¦¬í•´ì£¼ì„¸ìš”.</u>


```python
pip install seaborn
```

    Requirement already satisfied: seaborn in /usr/local/lib/python3.6/dist-packages (0.11.2)
    Requirement already satisfied: scipy>=1.0 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.5.4)
    Requirement already satisfied: numpy>=1.15 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.19.5)
    Requirement already satisfied: matplotlib>=2.2 in /usr/local/lib/python3.6/dist-packages (from seaborn) (3.3.3)
    Requirement already satisfied: pandas>=0.23 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.1.5)
    Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (2.8.1)
    Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (0.10.0)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (2.4.7)
    Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (8.1.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (1.3.1)
    Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas>=0.23->seaborn) (2022.1)
    Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from cycler>=0.10->matplotlib>=2.2->seaborn) (1.15.0)
    [33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m
    Note: you may need to restart the kernel to use updated packages.



```python
import matplotlib.font_manager as fm
import seaborn as sns

fm.get_fontconfig_fonts()

font_list = [font.name for font in fm.fontManager.ttflist]
font_list
sns.set(font="NanumGothicCoding", 
        rc={"axes.unicode_minus":False}, # ë§ˆì´ë„ˆìŠ¤ ë¶€í˜¸ ê¹¨ì§ í˜„ìƒ í•´ê²°
        style='darkgrid')
```


```python
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
# ì•„ë˜ì— ì‹¤ìŠµì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.

import seaborn as sns
import matplotlib.pyplot as plt

sns.pairplot(df_total)
plt.show()

```


![output_18_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/405cdf19-212c-4742-abfc-ff4412397f1b)
    



```python
df_total.info() # 109642 
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
df_total = df_total[df_total['ET'] <= 20000]
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109640 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109640 non-null  object 
     1   TIME_DEPARTUREDATE  109640 non-null  object 
     2   TIME_ARRIVEDATE     109640 non-null  object 
     3   A_DISTANCE          109640 non-null  float64
     4   ET                  109640 non-null  float64
     5   ETA                 109640 non-null  float64
     6   ETAA                109640 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
sns.pairplot(df_total)
plt.show()
```

![output_21_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/ea0ffdf8-7240-45be-8eb1-a93037c66e9c)


    



```python
# í‰ê· ì‹œì† ë³€ìˆ˜ ë¶„í¬ë„ ë§Œë“¤ê¸°
# ë‹¨ìœ„ A_DISTANCE : ë¯¸í„°, ET : ì´ˆ
df_total['perhour'] = (df_total['A_DISTANCE']/1000) / (df_total['ET']/3600)

```


```python
len(df_total[df_total['perhour'] >= 130])
```




    60




```python
# 130ì´ìƒì†ë„ ì œê±°
df_total = df_total[df_total['perhour'] < 130]
```


```python
sns.pairplot(df_total)
plt.show()
```

    
![output_25_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/8fd43b92-894c-42de-83cc-b34929b01fb2)



```python
# ì¶”ê°€ë°ì´í„° í•©ì¹˜ê¸°
df_pnu = pd.read_csv('onenavi_pnu.csv', sep='|')
df_pnu.info()
# df_pnu['level1_pnu'].value_counts()


```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 442376 entries, 0 to 442375
    Data columns (total 3 columns):
     #   Column      Non-Null Count   Dtype 
    ---  ------      --------------   ----- 
     0   RID         442376 non-null  object
     1   level1_pnu  442376 non-null  object
     2   level2_pnu  442376 non-null  object
    dtypes: object(3)
    memory usage: 10.1+ MB



```python
df_tt = pd.merge(df_total, df_pnu, on='RID')
df_tt.info()
df_tt['level1_pnu'].value_counts()

```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109580 entries, 0 to 109579
    Data columns (total 10 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109580 non-null  object 
     1   TIME_DEPARTUREDATE  109580 non-null  object 
     2   TIME_ARRIVEDATE     109580 non-null  object 
     3   A_DISTANCE          109580 non-null  float64
     4   ET                  109580 non-null  float64
     5   ETA                 109580 non-null  float64
     6   ETAA                109580 non-null  float64
     7   perhour             109580 non-null  float64
     8   level1_pnu          109580 non-null  object 
     9   level2_pnu          109580 non-null  object 
    dtypes: float64(5), object(5)
    memory usage: 9.2+ MB





    ê²½ê¸°ë„      66592
    ì„œìš¸íŠ¹ë³„ì‹œ    42561
    ì¸ì²œê´‘ì—­ì‹œ      332
    -           91
    ê°•ì›ë„          2
    ì¶©ì²­ë‚¨ë„         1
    ì¶©ì²­ë¶ë„         1
    Name: level1_pnu, dtype: int64




```python
df_tt = df_tt[(df_tt['level1_pnu'] == 'ê²½ê¸°ë„') | 
          (df_tt['level1_pnu'] == 'ì„œìš¸íŠ¹ë³„ì‹œ') | 
          (df_tt['level1_pnu'] == 'ì¸ì²œê´‘ì—­ì‹œ')]

```


```python
df_tt.reset_index(drop=True)
df_tt.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109485 entries, 0 to 109579
    Data columns (total 10 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109485 non-null  object 
     1   TIME_DEPARTUREDATE  109485 non-null  object 
     2   TIME_ARRIVEDATE     109485 non-null  object 
     3   A_DISTANCE          109485 non-null  float64
     4   ET                  109485 non-null  float64
     5   ETA                 109485 non-null  float64
     6   ETAA                109485 non-null  float64
     7   perhour             109485 non-null  float64
     8   level1_pnu          109485 non-null  object 
     9   level2_pnu          109485 non-null  object 
    dtypes: float64(5), object(5)
    memory usage: 9.2+ MB



```python
df_signal = pd.read_csv('onenavi_signal.csv', sep='|')
df_signal.describe()

df_tt = pd.merge(df_tt, df_signal, on='RID')
df_tt.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 11 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
    dtypes: float64(6), object(5)
    memory usage: 10.0+ MB



```python
sns.pairplot(df_tt)
plt.show()
```
    
![output_31_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/54069c02-1167-48d3-ad54-514f291da46c)


### ì‹¤ìŠµ3. <u>ì´ìƒì¹˜ë¥¼ íŒë‹¨í•œ ê¸°ì¤€(ì•„ì´ë””ì–´)ê³¼ ì²˜ë¦¬í•œ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”.</u>


```python
# ì•„ë˜ì— ììœ ë¡­ê²Œ ì•„ì´ë””ì–´ë¥¼ ì ì–´ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  ì‹¤ì œë¡œ ì´ìƒì¹˜ë¥¼ ì²˜ë¦¬í–ˆë‹¤ë©´ ì²˜ë¦¬í•œ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”.
# ì•„ì´ë””ì–´ : 
# ì´ìƒì¹˜ ì²˜ë¦¬ :

# 1. ETê°€ ë„ˆë¬´ í¼ : ì¼ì •ì¹˜ ì´ìƒì´ë©´ ì‚­ì œ
# 2. Km/hour ë¥¼ ìƒì„± : 130 ì´ìƒì´ë©´ ì‚­ì œ
# 3. ìˆ˜ë„ê¶Œ ì™¸ ì§€ì—­ ì‚­ì œ
df_total = df_tt.copy()




```


```python
df_total.info()
df_total
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 11 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
    dtypes: float64(6), object(5)
    memory usage: 10.0+ MB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RID</th>
      <th>TIME_DEPARTUREDATE</th>
      <th>TIME_ARRIVEDATE</th>
      <th>A_DISTANCE</th>
      <th>ET</th>
      <th>ETA</th>
      <th>ETAA</th>
      <th>perhour</th>
      <th>level1_pnu</th>
      <th>level2_pnu</th>
      <th>signaltype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>router-84875df7fc-b5nxc-7-20255166-0</td>
      <td>2020-07-20 05:35:21.000</td>
      <td>2020-07-20 05:55:22.599</td>
      <td>12914.0</td>
      <td>1201.534058</td>
      <td>987.624634</td>
      <td>82.196974</td>
      <td>38.692536</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê´‘ëª…ì‹œ</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>router-84875df7fc-b5nxc-6-10888379-0</td>
      <td>2020-07-20 05:55:22.000</td>
      <td>2020-07-20 06:09:06.941</td>
      <td>7483.0</td>
      <td>823.817017</td>
      <td>855.933716</td>
      <td>96.101477</td>
      <td>32.699980</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ì˜ë“±í¬êµ¬</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>router-84875df7fc-cmkz9-7-45806143-0</td>
      <td>2020-07-20 00:13:46.000</td>
      <td>2020-07-20 00:22:32.909</td>
      <td>8087.0</td>
      <td>526.710999</td>
      <td>575.954529</td>
      <td>90.650750</td>
      <td>55.273575</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê¹€í¬ì‹œ</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>router-84875df7fc-scxcj-7-47843617-0</td>
      <td>2020-07-20 00:13:43.000</td>
      <td>2020-07-20 00:28:42.729</td>
      <td>10528.0</td>
      <td>898.581970</td>
      <td>537.117004</td>
      <td>59.773846</td>
      <td>42.178456</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê´‘ì£¼ì‹œ</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>router-84875df7fc-scxcj-3-20061505-0</td>
      <td>2020-07-20 00:01:57.000</td>
      <td>2020-07-20 00:17:58.169</td>
      <td>10636.0</td>
      <td>957.758972</td>
      <td>786.352539</td>
      <td>82.103385</td>
      <td>39.978326</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì•ˆì‚°ì‹œ ìƒë¡êµ¬</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>router-84875df7fc-b5nxc-0-6856031-0</td>
      <td>2020-07-31 11:09:24.000</td>
      <td>2020-07-31 11:15:59.833</td>
      <td>4457.0</td>
      <td>393.873993</td>
      <td>633.093689</td>
      <td>39.264917</td>
      <td>40.736886</td>
      <td>ê²½ê¸°ë„</td>
      <td>ìš©ì¸ì‹œ ì²˜ì¸êµ¬</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>router-84875df7fc-cmkz9-7-71080475-0</td>
      <td>2020-07-31 11:09:25.000</td>
      <td>2020-07-31 11:17:26.427</td>
      <td>5518.0</td>
      <td>478.945007</td>
      <td>377.083557</td>
      <td>78.732120</td>
      <td>41.476161</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ê´‘ì§„êµ¬</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>router-84875df7fc-cmkz9-7-71082304-0</td>
      <td>2020-07-31 11:10:04.000</td>
      <td>2020-07-31 11:14:01.092</td>
      <td>4025.0</td>
      <td>223.481995</td>
      <td>412.308411</td>
      <td>15.507101</td>
      <td>64.837438</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì—°ì²œêµ°</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>router-84875df7fc-b5nxc-4-75603454-0</td>
      <td>2020-07-31 11:11:46.000</td>
      <td>2020-07-31 11:17:47.095</td>
      <td>3372.0</td>
      <td>360.329010</td>
      <td>580.275146</td>
      <td>38.959637</td>
      <td>33.689211</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>router-84875df7fc-cmkz9-4-33283055-0</td>
      <td>2020-07-31 11:11:16.000</td>
      <td>2020-07-31 11:16:47.495</td>
      <td>3659.0</td>
      <td>330.881989</td>
      <td>365.540833</td>
      <td>89.525316</td>
      <td>39.809964</td>
      <td>ê²½ê¸°ë„</td>
      <td>íŒŒì£¼ì‹œ</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows Ã— 11 columns</p>
</div>



# 3. ë”ë¯¸ë³€ìˆ˜ ìƒì„±
## ë²”ì£¼í˜• ë°ì´í„°ë„ ëª¨ë¸ë§ì— í™œìš©í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë”ë¯¸ë³€ìˆ˜ë¡œ ë³€í™˜í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
+ KeyPoint : ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ ë”ë¯¸ë³€ìˆ˜ë¡œ ë³€í™˜í•  ìˆ˜ ìˆë‹¤.

#### ë²”ì£¼í˜• ë³€ìˆ˜ ì¤‘ì— ì–´ë–¤ ë³€ìˆ˜ë¥¼ ë”ë¯¸ë¡œ ë³€í™˜í•´ë³¼ê¹Œìš”?
#### ìš”ì¼, ì‹œê°„, ì‹œë„ ë³€ìˆ˜ë¥¼ ë”ë¯¸í™” í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

### ì‹¤ìŠµ4. <u>ìš”ì¼, ì‹œê°„, ë‚ ì§œ ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ê³  ìš”ì¼, ì‹œê°„, ë‚ ì§œ, level1_pnuë¥¼ ë”ë¯¸ë³€ìˆ˜ë¡œ ë§Œë“¤ì–´ë´…ì‹œë‹¤.</u>


```python
!pip install tqdm
```

    Requirement already satisfied: tqdm in /usr/local/lib/python3.6/dist-packages (4.62.2)
    [33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m



```python
# ì•„ë˜ì— ì‹¤ìŠµì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
# Hint1
## for w in df_total['TIME_DEPARTUREDATE']:
##     parse_data_w = parse(w)
##     weekday_list.append(parse_data_w.weekday())
##     hour_list.append(parse_data_w.hour)
##     day_list.append(parse_data_w.day)
# Hint2 : pandas.get_dummies


import datetime
from dateutil.parser import parse
from tqdm import tqdm


weekday_list=[]
hour_list=[]
day_list=[]

# 2020-07-20 05:35:21.000
for w in df_total['TIME_DEPARTUREDATE']:
    parse_data_w = parse(w)
    weekday_list.append(parse_data_w.weekday())
    hour_list.append(parse_data_w.hour)
    day_list.append(parse_data_w.day)

df_total['WEEKDAY'] = weekday_list
df_total['HOUR'] = hour_list
df_total['DAY'] = day_list    
```


```python
df_total.info()
df_total
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 14 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
     11  WEEKDAY             109175 non-null  int64  
     12  HOUR                109175 non-null  int64  
     13  DAY                 109175 non-null  int64  
    dtypes: float64(6), int64(3), object(5)
    memory usage: 12.5+ MB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RID</th>
      <th>TIME_DEPARTUREDATE</th>
      <th>TIME_ARRIVEDATE</th>
      <th>A_DISTANCE</th>
      <th>ET</th>
      <th>ETA</th>
      <th>ETAA</th>
      <th>perhour</th>
      <th>level1_pnu</th>
      <th>level2_pnu</th>
      <th>signaltype</th>
      <th>WEEKDAY</th>
      <th>HOUR</th>
      <th>DAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>router-84875df7fc-b5nxc-7-20255166-0</td>
      <td>2020-07-20 05:35:21.000</td>
      <td>2020-07-20 05:55:22.599</td>
      <td>12914.0</td>
      <td>1201.534058</td>
      <td>987.624634</td>
      <td>82.196974</td>
      <td>38.692536</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê´‘ëª…ì‹œ</td>
      <td>7.0</td>
      <td>0</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>router-84875df7fc-b5nxc-6-10888379-0</td>
      <td>2020-07-20 05:55:22.000</td>
      <td>2020-07-20 06:09:06.941</td>
      <td>7483.0</td>
      <td>823.817017</td>
      <td>855.933716</td>
      <td>96.101477</td>
      <td>32.699980</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ì˜ë“±í¬êµ¬</td>
      <td>31.0</td>
      <td>0</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>router-84875df7fc-cmkz9-7-45806143-0</td>
      <td>2020-07-20 00:13:46.000</td>
      <td>2020-07-20 00:22:32.909</td>
      <td>8087.0</td>
      <td>526.710999</td>
      <td>575.954529</td>
      <td>90.650750</td>
      <td>55.273575</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê¹€í¬ì‹œ</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>router-84875df7fc-scxcj-7-47843617-0</td>
      <td>2020-07-20 00:13:43.000</td>
      <td>2020-07-20 00:28:42.729</td>
      <td>10528.0</td>
      <td>898.581970</td>
      <td>537.117004</td>
      <td>59.773846</td>
      <td>42.178456</td>
      <td>ê²½ê¸°ë„</td>
      <td>ê´‘ì£¼ì‹œ</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>router-84875df7fc-scxcj-3-20061505-0</td>
      <td>2020-07-20 00:01:57.000</td>
      <td>2020-07-20 00:17:58.169</td>
      <td>10636.0</td>
      <td>957.758972</td>
      <td>786.352539</td>
      <td>82.103385</td>
      <td>39.978326</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì•ˆì‚°ì‹œ ìƒë¡êµ¬</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>router-84875df7fc-b5nxc-0-6856031-0</td>
      <td>2020-07-31 11:09:24.000</td>
      <td>2020-07-31 11:15:59.833</td>
      <td>4457.0</td>
      <td>393.873993</td>
      <td>633.093689</td>
      <td>39.264917</td>
      <td>40.736886</td>
      <td>ê²½ê¸°ë„</td>
      <td>ìš©ì¸ì‹œ ì²˜ì¸êµ¬</td>
      <td>21.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>router-84875df7fc-cmkz9-7-71080475-0</td>
      <td>2020-07-31 11:09:25.000</td>
      <td>2020-07-31 11:17:26.427</td>
      <td>5518.0</td>
      <td>478.945007</td>
      <td>377.083557</td>
      <td>78.732120</td>
      <td>41.476161</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ê´‘ì§„êµ¬</td>
      <td>0.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>router-84875df7fc-cmkz9-7-71082304-0</td>
      <td>2020-07-31 11:10:04.000</td>
      <td>2020-07-31 11:14:01.092</td>
      <td>4025.0</td>
      <td>223.481995</td>
      <td>412.308411</td>
      <td>15.507101</td>
      <td>64.837438</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì—°ì²œêµ°</td>
      <td>2.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>router-84875df7fc-b5nxc-4-75603454-0</td>
      <td>2020-07-31 11:11:46.000</td>
      <td>2020-07-31 11:17:47.095</td>
      <td>3372.0</td>
      <td>360.329010</td>
      <td>580.275146</td>
      <td>38.959637</td>
      <td>33.689211</td>
      <td>ê²½ê¸°ë„</td>
      <td>ì„±ë‚¨ì‹œ ë¶„ë‹¹êµ¬</td>
      <td>10.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>router-84875df7fc-cmkz9-4-33283055-0</td>
      <td>2020-07-31 11:11:16.000</td>
      <td>2020-07-31 11:16:47.495</td>
      <td>3659.0</td>
      <td>330.881989</td>
      <td>365.540833</td>
      <td>89.525316</td>
      <td>39.809964</td>
      <td>ê²½ê¸°ë„</td>
      <td>íŒŒì£¼ì‹œ</td>
      <td>1.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
  </tbody>
</table>
<p>109175 rows Ã— 14 columns</p>
</div>




```python
print(len(df_total))
print(len(df_total[df_total['DAY']>=27]))
```

    109175
    53742



```python
# í‰ê°€ë°ì´í„° ë³„ë„ ì €ì¥ : ì›ë³¸ ê¸°ì¤€(ë‚˜ì¤‘ì— í™œìš©) test_Y
new_df_eval=df_total[df_total['DAY']>=27]
new_df_eval.to_csv("e.csv",sep="|",index=False)
```


```python
# df_total.info()

dummy_fields = ['WEEKDAY','HOUR','level1_pnu','level2_pnu']
df_11 = pd.get_dummies(df_total, columns=dummy_fields, drop_first=False)
# df_11.drop(columns=dummy_fields)
df_11.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Columns: 115 entries, RID to level2_pnu_í™”ì„±ì‹œ
    dtypes: float64(6), int64(1), object(3), uint8(105)
    memory usage: 20.1+ MB



```python

# ìš”ì¼, ì‹œê°„, level1_pnu, level2_pnu
dummy_fields = ['WEEKDAY','HOUR','level1_pnu','level2_pnu']

for dummy in dummy_fields:
    dummies = pd.get_dummies(df_total[dummy], prefix=dummy, drop_first=False)
    df_total = pd.concat([df_total, dummies], axis=1)
    
df_total = df_total.drop(dummy_fields,axis=1)
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Columns: 115 entries, RID to level2_pnu_í™”ì„±ì‹œ
    dtypes: float64(6), int64(1), object(3), uint8(105)
    memory usage: 20.1+ MB


# 4. ë°ì´í„° ìŠ¤ì¼€ì¼ë§
##  Featureë“¤ì˜ í¬ê¸°, ë²”ì£¼ë¥¼ ì •ê·œí™”í•˜ëŠ” ê³¼ì •ì„ í†µí•´ íŠ¹ì •ë³€ìˆ˜ì˜ ì˜í–¥ë„ë¥¼ ì¡°ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
+ KeyPoint : ë°ì´í„° ìŠ¤ì¼€ì¼ë§ì„ í†µí•´ AIëª¨ë¸ í•™ìŠµì— ë„ì›€ì„ ì¤„ ìˆ˜ ìˆë‹¤.

### ì‹¤ìŠµ5. <u>df_totalì„ MinMaxScalerë¡œ ë°ì´í„° ìŠ¤ì¼€ì¼ë§ì„ ì§„í–‰í•˜ê³  feature ë³€ìˆ˜ë¡œ ì €ì¥í•´ì£¼ì„¸ìš”.</u>
* ë‹¨, ë‚ ì§œê°€ ìŠ¤ì¼€ì¼ë§ì´ ë˜ë©´ ì•ˆë©ë‹ˆë‹¤. ë³„ë„ë¡œ ì €ì¥í•´ì£¼ì—ˆë‹¤ê°€ ë‚˜ì¤‘ì— í•©ì³ì£¼ì„¸ìš”.
* data_day = df_total['DAY']


```python
# ì•„ë˜ì— ì‹¤ìŠµì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.(Hint : from sklearn.preprocessing import MinMaxScaler)
# ìŠ¤ì¼€ì¼ë§ì´ ë¶ˆê°€ëŠ¥í•œ ë°ì´í„°(ë¬¸ìí˜•, ë‚ ì§œí˜• ë“±)ì™€ ìš°ë¦¬ì˜ ëª©ì ì¸ Target(ET)ì€ ìŠ¤ì¼€ì¼ë§ì„ í•˜ì‹œë©´ ì•ˆë©ë‹ˆë‹¤.
```


```python
# ê¸°ì¤€ì¼ì ì €ì¥ : why? ë‚ ì§œê°€ ìŠ¤ì¼€ì¼ë§ì´ ë˜ë©´ ì•ˆë©ë‹ˆë‹¤.
data_day=df_total['DAY']
```


```python
train_data=df_total.drop(['RID','TIME_DEPARTUREDATE','TIME_ARRIVEDATE','ET','ETAA','perhour','DAY'],axis=1)
columnNames=train_data.columns
train_data




```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_DISTANCE</th>
      <th>ETA</th>
      <th>signaltype</th>
      <th>WEEKDAY_0</th>
      <th>WEEKDAY_1</th>
      <th>WEEKDAY_2</th>
      <th>WEEKDAY_3</th>
      <th>WEEKDAY_4</th>
      <th>HOUR_0</th>
      <th>HOUR_1</th>
      <th>...</th>
      <th>level2_pnu_ì˜ì •ë¶€ì‹œ</th>
      <th>level2_pnu_ì´ì²œì‹œ</th>
      <th>level2_pnu_ì¢…ë¡œêµ¬</th>
      <th>level2_pnu_ì¤‘êµ¬</th>
      <th>level2_pnu_ì¤‘ë‘êµ¬</th>
      <th>level2_pnu_íŒŒì£¼ì‹œ</th>
      <th>level2_pnu_í‰íƒì‹œ</th>
      <th>level2_pnu_í¬ì²œì‹œ</th>
      <th>level2_pnu_í•˜ë‚¨ì‹œ</th>
      <th>level2_pnu_í™”ì„±ì‹œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12914.0</td>
      <td>987.624634</td>
      <td>7.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7483.0</td>
      <td>855.933716</td>
      <td>31.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8087.0</td>
      <td>575.954529</td>
      <td>6.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10528.0</td>
      <td>537.117004</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10636.0</td>
      <td>786.352539</td>
      <td>28.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>4457.0</td>
      <td>633.093689</td>
      <td>21.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>5518.0</td>
      <td>377.083557</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>4025.0</td>
      <td>412.308411</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>3372.0</td>
      <td>580.275146</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>3659.0</td>
      <td>365.540833</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows Ã— 108 columns</p>
</div>




```python
# ìŠ¤ì¼€ì¼ë§
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler(feature_range=(0, 1))
feature = pd.DataFrame(scaler.fit_transform(train_data))
feature.columns=columnNames
feature
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_DISTANCE</th>
      <th>ETA</th>
      <th>signaltype</th>
      <th>WEEKDAY_0</th>
      <th>WEEKDAY_1</th>
      <th>WEEKDAY_2</th>
      <th>WEEKDAY_3</th>
      <th>WEEKDAY_4</th>
      <th>HOUR_0</th>
      <th>HOUR_1</th>
      <th>...</th>
      <th>level2_pnu_ì˜ì •ë¶€ì‹œ</th>
      <th>level2_pnu_ì´ì²œì‹œ</th>
      <th>level2_pnu_ì¢…ë¡œêµ¬</th>
      <th>level2_pnu_ì¤‘êµ¬</th>
      <th>level2_pnu_ì¤‘ë‘êµ¬</th>
      <th>level2_pnu_íŒŒì£¼ì‹œ</th>
      <th>level2_pnu_í‰íƒì‹œ</th>
      <th>level2_pnu_í¬ì²œì‹œ</th>
      <th>level2_pnu_í•˜ë‚¨ì‹œ</th>
      <th>level2_pnu_í™”ì„±ì‹œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.826167</td>
      <td>0.216722</td>
      <td>0.064815</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.373583</td>
      <td>0.185241</td>
      <td>0.287037</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.423917</td>
      <td>0.118311</td>
      <td>0.055556</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.627333</td>
      <td>0.109026</td>
      <td>0.018519</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.636333</td>
      <td>0.168607</td>
      <td>0.259259</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>0.121417</td>
      <td>0.131970</td>
      <td>0.194444</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>0.209833</td>
      <td>0.070770</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>0.085417</td>
      <td>0.079190</td>
      <td>0.018519</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>0.031000</td>
      <td>0.119343</td>
      <td>0.092593</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>0.054917</td>
      <td>0.068010</td>
      <td>0.009259</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows Ã— 108 columns</p>
</div>



---

## ë‹¤ìŒ ë‹¨ê³„ë¥¼ ìœ„í•´ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê² ìŠµë‹ˆë‹¤.


```python
data_day
```




    0         20
    1         20
    2         20
    3         20
    4         20
              ..
    109170    31
    109171    31
    109172    31
    109173    31
    109174    31
    Name: DAY, Length: 109175, dtype: int64




```python
# ë‹¤ì‹œ ë‚ ì§œë¥¼ í•©ì¹ ê»˜ìš” : Train/Evaluation ë¶„ë¦¬ë¥¼ ìœ„í•´ 
feature['DAY']=data_day
# traindata ì§€ì •
train_feature=feature[feature['DAY']<=24]
train_feature=train_feature.drop(['DAY'],axis=1)
eval_feature=feature[feature['DAY']>=27]
eval_feature=eval_feature.drop(['DAY'],axis=1)
```


```python
len(feature),len(train_feature),len(eval_feature)
```




    (109175, 55433, 53742)




```python
# target ì €ì¥
train_target = df_total[df_total['DAY']<=24]['ET']
train_target
```




    0        1201.534058
    1         823.817017
    2         526.710999
    3         898.581970
    4         957.758972
                ...     
    55428     544.301025
    55429     535.666992
    55430     610.799988
    55431     878.479004
    55432     553.580994
    Name: ET, Length: 55433, dtype: float64




```python
# CSVë¡œ ì €ì¥
train_feature.to_csv('onenavi_train_feature.csv',index = False,sep='|')
train_target.to_csv('onenavi_train_target.csv',index = False,sep='|')
eval_feature.to_csv('onenavi_eval_feature.csv',index = False,sep='|')
```


```python
feature.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 109175 entries, 0 to 109174
    Columns: 109 entries, A_DISTANCE to DAY
    dtypes: float64(108), int64(1)
    memory usage: 90.8 MB



```python
train_feature.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 55433 entries, 0 to 55432
    Columns: 108 entries, A_DISTANCE to level2_pnu_í™”ì„±ì‹œ
    dtypes: float64(108)
    memory usage: 46.1 MB



```python

```


```python

```
