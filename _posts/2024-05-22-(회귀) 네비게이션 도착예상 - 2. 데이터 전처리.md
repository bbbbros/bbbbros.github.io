# 데이터 불러오기부터

### 가. 라이브러리 Import


```python
import pandas as pd
import numpy as np
```

### 나. 데이터 불러오기

### 만약에 Train/Evaluation 데이터를 따로 전처리 한다면?
* 전처리 기준(특히 정규화 작업 시)이 달라져서 모델의 성능에 악영향을 줄 수 있음


```python

```


```python
# 데이터 셋 로딩
df = pd.read_csv("onenavi_train.csv", sep = "|")
df_eval = pd.read_csv("onenavi_evaluation.csv", sep = "|")
# 학습/평가 데이터의 전처리 기준을 통일하기위해 데이터 합본
df_total=pd.concat([df,df_eval],ignore_index=True)
# 추가 데이터 셋 로딩
# df_pnu = pd.read_csv("onenavi_pnu.csv",sep="|") # 주소(시도/시군구 정보)
# df_signal = pd.read_csv("onenavi_signal.csv",sep="|") # 경로의 신호등 갯수
# # 데이터 합치기
# df_total=pd.merge(df_total,df_pnu , on="RID")
# df_total=pd.merge(df_total,df_signal , on="RID")
# df_total
```

---

# 1. 이상치/결측치 처리
## Trash를 판별하는 능력은 좋은 AI모델을 만드는 데 있어 핵심입니다.
+ KeyPoint : 데이터의 형태를 살펴보고 불필요한 데이터를 정제할 수 있다.

[참고] 공식 Document
+ fillna(https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html)
+ dropna(https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html)

### 가. 결측치 처리

### 실습1. <u>df_total의 결측치를 확인하고 결측치가 존재한다면 제거해주세요.</u>


```python
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 5.9+ MB



```python
# 아래에 실습코드를 작성하고 결과를 확인합니다.(Hint : dataframedf_total.isnull().sum() // dropna(), fillna())
print(df_total.isna().sum())

# NULL값 삭제
df_total = df_total.dropna()

df_total.info()
```

    RID                   0
    TIME_DEPARTUREDATE    0
    TIME_ARRIVEDATE       0
    A_DISTANCE            0
    ET                    0
    ETA                   0
    ETAA                  0
    dtype: int64
    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB


### 나. 이상치 처리
#### 이상치(Outlier)는 전적으로 연구자 혹은 개발자가 판단을 해야한다. 자세히 살펴보지않으면 놓치기 쉽상이다.
#### "자세히 보아야 드러난다. 오래 보아야 도움이 된다. Outlier가 그렇다."

### 실습2. <u>시각화 기법 및 데이터 분포를 확인하고 df_total의 이상치를 전처리해주세요.</u>


```python
pip install seaborn
```

    Requirement already satisfied: seaborn in /usr/local/lib/python3.6/dist-packages (0.11.2)
    Requirement already satisfied: scipy>=1.0 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.5.4)
    Requirement already satisfied: numpy>=1.15 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.19.5)
    Requirement already satisfied: matplotlib>=2.2 in /usr/local/lib/python3.6/dist-packages (from seaborn) (3.3.3)
    Requirement already satisfied: pandas>=0.23 in /usr/local/lib/python3.6/dist-packages (from seaborn) (1.1.5)
    Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (2.8.1)
    Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (0.10.0)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (2.4.7)
    Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (8.1.0)
    Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=2.2->seaborn) (1.3.1)
    Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas>=0.23->seaborn) (2022.1)
    Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from cycler>=0.10->matplotlib>=2.2->seaborn) (1.15.0)
    [33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m
    Note: you may need to restart the kernel to use updated packages.



```python
import matplotlib.font_manager as fm
import seaborn as sns

fm.get_fontconfig_fonts()

font_list = [font.name for font in fm.fontManager.ttflist]
font_list
sns.set(font="NanumGothicCoding", 
        rc={"axes.unicode_minus":False}, # 마이너스 부호 깨짐 현상 해결
        style='darkgrid')
```


```python
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
# 아래에 실습코드를 작성하고 결과를 확인합니다.

import seaborn as sns
import matplotlib.pyplot as plt

sns.pairplot(df_total)
plt.show()

```


![output_18_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/405cdf19-212c-4742-abfc-ff4412397f1b)
    



```python
df_total.info() # 109642 
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109642 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109642 non-null  object 
     1   TIME_DEPARTUREDATE  109642 non-null  object 
     2   TIME_ARRIVEDATE     109642 non-null  object 
     3   A_DISTANCE          109642 non-null  float64
     4   ET                  109642 non-null  float64
     5   ETA                 109642 non-null  float64
     6   ETAA                109642 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
df_total = df_total[df_total['ET'] <= 20000]
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109640 entries, 0 to 109641
    Data columns (total 7 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109640 non-null  object 
     1   TIME_DEPARTUREDATE  109640 non-null  object 
     2   TIME_ARRIVEDATE     109640 non-null  object 
     3   A_DISTANCE          109640 non-null  float64
     4   ET                  109640 non-null  float64
     5   ETA                 109640 non-null  float64
     6   ETAA                109640 non-null  float64
    dtypes: float64(4), object(3)
    memory usage: 6.7+ MB



```python
sns.pairplot(df_total)
plt.show()
```

![output_21_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/ea0ffdf8-7240-45be-8eb1-a93037c66e9c)


    



```python
# 평균시속 변수 분포도 만들기
# 단위 A_DISTANCE : 미터, ET : 초
df_total['perhour'] = (df_total['A_DISTANCE']/1000) / (df_total['ET']/3600)

```


```python
len(df_total[df_total['perhour'] >= 130])
```




    60




```python
# 130이상속도 제거
df_total = df_total[df_total['perhour'] < 130]
```


```python
sns.pairplot(df_total)
plt.show()
```

    
![output_25_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/8fd43b92-894c-42de-83cc-b34929b01fb2)



```python
# 추가데이터 합치기
df_pnu = pd.read_csv('onenavi_pnu.csv', sep='|')
df_pnu.info()
# df_pnu['level1_pnu'].value_counts()


```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 442376 entries, 0 to 442375
    Data columns (total 3 columns):
     #   Column      Non-Null Count   Dtype 
    ---  ------      --------------   ----- 
     0   RID         442376 non-null  object
     1   level1_pnu  442376 non-null  object
     2   level2_pnu  442376 non-null  object
    dtypes: object(3)
    memory usage: 10.1+ MB



```python
df_tt = pd.merge(df_total, df_pnu, on='RID')
df_tt.info()
df_tt['level1_pnu'].value_counts()

```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109580 entries, 0 to 109579
    Data columns (total 10 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109580 non-null  object 
     1   TIME_DEPARTUREDATE  109580 non-null  object 
     2   TIME_ARRIVEDATE     109580 non-null  object 
     3   A_DISTANCE          109580 non-null  float64
     4   ET                  109580 non-null  float64
     5   ETA                 109580 non-null  float64
     6   ETAA                109580 non-null  float64
     7   perhour             109580 non-null  float64
     8   level1_pnu          109580 non-null  object 
     9   level2_pnu          109580 non-null  object 
    dtypes: float64(5), object(5)
    memory usage: 9.2+ MB





    경기도      66592
    서울특별시    42561
    인천광역시      332
    -           91
    강원도          2
    충청남도         1
    충청북도         1
    Name: level1_pnu, dtype: int64




```python
df_tt = df_tt[(df_tt['level1_pnu'] == '경기도') | 
          (df_tt['level1_pnu'] == '서울특별시') | 
          (df_tt['level1_pnu'] == '인천광역시')]

```


```python
df_tt.reset_index(drop=True)
df_tt.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109485 entries, 0 to 109579
    Data columns (total 10 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109485 non-null  object 
     1   TIME_DEPARTUREDATE  109485 non-null  object 
     2   TIME_ARRIVEDATE     109485 non-null  object 
     3   A_DISTANCE          109485 non-null  float64
     4   ET                  109485 non-null  float64
     5   ETA                 109485 non-null  float64
     6   ETAA                109485 non-null  float64
     7   perhour             109485 non-null  float64
     8   level1_pnu          109485 non-null  object 
     9   level2_pnu          109485 non-null  object 
    dtypes: float64(5), object(5)
    memory usage: 9.2+ MB



```python
df_signal = pd.read_csv('onenavi_signal.csv', sep='|')
df_signal.describe()

df_tt = pd.merge(df_tt, df_signal, on='RID')
df_tt.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 11 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
    dtypes: float64(6), object(5)
    memory usage: 10.0+ MB



```python
sns.pairplot(df_tt)
plt.show()
```
    
![output_31_0](https://github.com/bbbbros/bbbbros.github.io/assets/161530952/54069c02-1167-48d3-ad54-514f291da46c)


### 실습3. <u>이상치를 판단한 기준(아이디어)과 처리한 내용을 적어주세요.</u>


```python
# 아래에 자유롭게 아이디어를 적어주세요. 그리고 실제로 이상치를 처리했다면 처리한 내용을 적어주세요.
# 아이디어 : 
# 이상치 처리 :

# 1. ET가 너무 큼 : 일정치 이상이면 삭제
# 2. Km/hour 를 생성 : 130 이상이면 삭제
# 3. 수도권 외 지역 삭제
df_total = df_tt.copy()




```


```python
df_total.info()
df_total
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 11 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
    dtypes: float64(6), object(5)
    memory usage: 10.0+ MB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RID</th>
      <th>TIME_DEPARTUREDATE</th>
      <th>TIME_ARRIVEDATE</th>
      <th>A_DISTANCE</th>
      <th>ET</th>
      <th>ETA</th>
      <th>ETAA</th>
      <th>perhour</th>
      <th>level1_pnu</th>
      <th>level2_pnu</th>
      <th>signaltype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>router-84875df7fc-b5nxc-7-20255166-0</td>
      <td>2020-07-20 05:35:21.000</td>
      <td>2020-07-20 05:55:22.599</td>
      <td>12914.0</td>
      <td>1201.534058</td>
      <td>987.624634</td>
      <td>82.196974</td>
      <td>38.692536</td>
      <td>경기도</td>
      <td>광명시</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>router-84875df7fc-b5nxc-6-10888379-0</td>
      <td>2020-07-20 05:55:22.000</td>
      <td>2020-07-20 06:09:06.941</td>
      <td>7483.0</td>
      <td>823.817017</td>
      <td>855.933716</td>
      <td>96.101477</td>
      <td>32.699980</td>
      <td>서울특별시</td>
      <td>영등포구</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>router-84875df7fc-cmkz9-7-45806143-0</td>
      <td>2020-07-20 00:13:46.000</td>
      <td>2020-07-20 00:22:32.909</td>
      <td>8087.0</td>
      <td>526.710999</td>
      <td>575.954529</td>
      <td>90.650750</td>
      <td>55.273575</td>
      <td>경기도</td>
      <td>김포시</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>router-84875df7fc-scxcj-7-47843617-0</td>
      <td>2020-07-20 00:13:43.000</td>
      <td>2020-07-20 00:28:42.729</td>
      <td>10528.0</td>
      <td>898.581970</td>
      <td>537.117004</td>
      <td>59.773846</td>
      <td>42.178456</td>
      <td>경기도</td>
      <td>광주시</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>router-84875df7fc-scxcj-3-20061505-0</td>
      <td>2020-07-20 00:01:57.000</td>
      <td>2020-07-20 00:17:58.169</td>
      <td>10636.0</td>
      <td>957.758972</td>
      <td>786.352539</td>
      <td>82.103385</td>
      <td>39.978326</td>
      <td>경기도</td>
      <td>안산시 상록구</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>router-84875df7fc-b5nxc-0-6856031-0</td>
      <td>2020-07-31 11:09:24.000</td>
      <td>2020-07-31 11:15:59.833</td>
      <td>4457.0</td>
      <td>393.873993</td>
      <td>633.093689</td>
      <td>39.264917</td>
      <td>40.736886</td>
      <td>경기도</td>
      <td>용인시 처인구</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>router-84875df7fc-cmkz9-7-71080475-0</td>
      <td>2020-07-31 11:09:25.000</td>
      <td>2020-07-31 11:17:26.427</td>
      <td>5518.0</td>
      <td>478.945007</td>
      <td>377.083557</td>
      <td>78.732120</td>
      <td>41.476161</td>
      <td>서울특별시</td>
      <td>광진구</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>router-84875df7fc-cmkz9-7-71082304-0</td>
      <td>2020-07-31 11:10:04.000</td>
      <td>2020-07-31 11:14:01.092</td>
      <td>4025.0</td>
      <td>223.481995</td>
      <td>412.308411</td>
      <td>15.507101</td>
      <td>64.837438</td>
      <td>경기도</td>
      <td>연천군</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>router-84875df7fc-b5nxc-4-75603454-0</td>
      <td>2020-07-31 11:11:46.000</td>
      <td>2020-07-31 11:17:47.095</td>
      <td>3372.0</td>
      <td>360.329010</td>
      <td>580.275146</td>
      <td>38.959637</td>
      <td>33.689211</td>
      <td>경기도</td>
      <td>성남시 분당구</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>router-84875df7fc-cmkz9-4-33283055-0</td>
      <td>2020-07-31 11:11:16.000</td>
      <td>2020-07-31 11:16:47.495</td>
      <td>3659.0</td>
      <td>330.881989</td>
      <td>365.540833</td>
      <td>89.525316</td>
      <td>39.809964</td>
      <td>경기도</td>
      <td>파주시</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows × 11 columns</p>
</div>



# 3. 더미변수 생성
## 범주형 데이터도 모델링에 활용할 수 있어야 합니다. 이를 위해 더미변수로 변환해주어야 합니다.
+ KeyPoint : 범주형 변수를 더미변수로 변환할 수 있다.

#### 범주형 변수 중에 어떤 변수를 더미로 변환해볼까요?
#### 요일, 시간, 시도 변수를 더미화 하면 좋을 것 같습니다.

### 실습4. <u>요일, 시간, 날짜 변수를 추가하고 요일, 시간, 날짜, level1_pnu를 더미변수로 만들어봅시다.</u>


```python
!pip install tqdm
```

    Requirement already satisfied: tqdm in /usr/local/lib/python3.6/dist-packages (4.62.2)
    [33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m



```python
# 아래에 실습코드를 작성하고 결과를 확인합니다.
# Hint1
## for w in df_total['TIME_DEPARTUREDATE']:
##     parse_data_w = parse(w)
##     weekday_list.append(parse_data_w.weekday())
##     hour_list.append(parse_data_w.hour)
##     day_list.append(parse_data_w.day)
# Hint2 : pandas.get_dummies


import datetime
from dateutil.parser import parse
from tqdm import tqdm


weekday_list=[]
hour_list=[]
day_list=[]

# 2020-07-20 05:35:21.000
for w in df_total['TIME_DEPARTUREDATE']:
    parse_data_w = parse(w)
    weekday_list.append(parse_data_w.weekday())
    hour_list.append(parse_data_w.hour)
    day_list.append(parse_data_w.day)

df_total['WEEKDAY'] = weekday_list
df_total['HOUR'] = hour_list
df_total['DAY'] = day_list    
```


```python
df_total.info()
df_total
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Data columns (total 14 columns):
     #   Column              Non-Null Count   Dtype  
    ---  ------              --------------   -----  
     0   RID                 109175 non-null  object 
     1   TIME_DEPARTUREDATE  109175 non-null  object 
     2   TIME_ARRIVEDATE     109175 non-null  object 
     3   A_DISTANCE          109175 non-null  float64
     4   ET                  109175 non-null  float64
     5   ETA                 109175 non-null  float64
     6   ETAA                109175 non-null  float64
     7   perhour             109175 non-null  float64
     8   level1_pnu          109175 non-null  object 
     9   level2_pnu          109175 non-null  object 
     10  signaltype          109175 non-null  float64
     11  WEEKDAY             109175 non-null  int64  
     12  HOUR                109175 non-null  int64  
     13  DAY                 109175 non-null  int64  
    dtypes: float64(6), int64(3), object(5)
    memory usage: 12.5+ MB





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RID</th>
      <th>TIME_DEPARTUREDATE</th>
      <th>TIME_ARRIVEDATE</th>
      <th>A_DISTANCE</th>
      <th>ET</th>
      <th>ETA</th>
      <th>ETAA</th>
      <th>perhour</th>
      <th>level1_pnu</th>
      <th>level2_pnu</th>
      <th>signaltype</th>
      <th>WEEKDAY</th>
      <th>HOUR</th>
      <th>DAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>router-84875df7fc-b5nxc-7-20255166-0</td>
      <td>2020-07-20 05:35:21.000</td>
      <td>2020-07-20 05:55:22.599</td>
      <td>12914.0</td>
      <td>1201.534058</td>
      <td>987.624634</td>
      <td>82.196974</td>
      <td>38.692536</td>
      <td>경기도</td>
      <td>광명시</td>
      <td>7.0</td>
      <td>0</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>router-84875df7fc-b5nxc-6-10888379-0</td>
      <td>2020-07-20 05:55:22.000</td>
      <td>2020-07-20 06:09:06.941</td>
      <td>7483.0</td>
      <td>823.817017</td>
      <td>855.933716</td>
      <td>96.101477</td>
      <td>32.699980</td>
      <td>서울특별시</td>
      <td>영등포구</td>
      <td>31.0</td>
      <td>0</td>
      <td>5</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>router-84875df7fc-cmkz9-7-45806143-0</td>
      <td>2020-07-20 00:13:46.000</td>
      <td>2020-07-20 00:22:32.909</td>
      <td>8087.0</td>
      <td>526.710999</td>
      <td>575.954529</td>
      <td>90.650750</td>
      <td>55.273575</td>
      <td>경기도</td>
      <td>김포시</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>router-84875df7fc-scxcj-7-47843617-0</td>
      <td>2020-07-20 00:13:43.000</td>
      <td>2020-07-20 00:28:42.729</td>
      <td>10528.0</td>
      <td>898.581970</td>
      <td>537.117004</td>
      <td>59.773846</td>
      <td>42.178456</td>
      <td>경기도</td>
      <td>광주시</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>router-84875df7fc-scxcj-3-20061505-0</td>
      <td>2020-07-20 00:01:57.000</td>
      <td>2020-07-20 00:17:58.169</td>
      <td>10636.0</td>
      <td>957.758972</td>
      <td>786.352539</td>
      <td>82.103385</td>
      <td>39.978326</td>
      <td>경기도</td>
      <td>안산시 상록구</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>router-84875df7fc-b5nxc-0-6856031-0</td>
      <td>2020-07-31 11:09:24.000</td>
      <td>2020-07-31 11:15:59.833</td>
      <td>4457.0</td>
      <td>393.873993</td>
      <td>633.093689</td>
      <td>39.264917</td>
      <td>40.736886</td>
      <td>경기도</td>
      <td>용인시 처인구</td>
      <td>21.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>router-84875df7fc-cmkz9-7-71080475-0</td>
      <td>2020-07-31 11:09:25.000</td>
      <td>2020-07-31 11:17:26.427</td>
      <td>5518.0</td>
      <td>478.945007</td>
      <td>377.083557</td>
      <td>78.732120</td>
      <td>41.476161</td>
      <td>서울특별시</td>
      <td>광진구</td>
      <td>0.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>router-84875df7fc-cmkz9-7-71082304-0</td>
      <td>2020-07-31 11:10:04.000</td>
      <td>2020-07-31 11:14:01.092</td>
      <td>4025.0</td>
      <td>223.481995</td>
      <td>412.308411</td>
      <td>15.507101</td>
      <td>64.837438</td>
      <td>경기도</td>
      <td>연천군</td>
      <td>2.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>router-84875df7fc-b5nxc-4-75603454-0</td>
      <td>2020-07-31 11:11:46.000</td>
      <td>2020-07-31 11:17:47.095</td>
      <td>3372.0</td>
      <td>360.329010</td>
      <td>580.275146</td>
      <td>38.959637</td>
      <td>33.689211</td>
      <td>경기도</td>
      <td>성남시 분당구</td>
      <td>10.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>router-84875df7fc-cmkz9-4-33283055-0</td>
      <td>2020-07-31 11:11:16.000</td>
      <td>2020-07-31 11:16:47.495</td>
      <td>3659.0</td>
      <td>330.881989</td>
      <td>365.540833</td>
      <td>89.525316</td>
      <td>39.809964</td>
      <td>경기도</td>
      <td>파주시</td>
      <td>1.0</td>
      <td>4</td>
      <td>11</td>
      <td>31</td>
    </tr>
  </tbody>
</table>
<p>109175 rows × 14 columns</p>
</div>




```python
print(len(df_total))
print(len(df_total[df_total['DAY']>=27]))
```

    109175
    53742



```python
# 평가데이터 별도 저장 : 원본 기준(나중에 활용) test_Y
new_df_eval=df_total[df_total['DAY']>=27]
new_df_eval.to_csv("e.csv",sep="|",index=False)
```


```python
# df_total.info()

dummy_fields = ['WEEKDAY','HOUR','level1_pnu','level2_pnu']
df_11 = pd.get_dummies(df_total, columns=dummy_fields, drop_first=False)
# df_11.drop(columns=dummy_fields)
df_11.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Columns: 115 entries, RID to level2_pnu_화성시
    dtypes: float64(6), int64(1), object(3), uint8(105)
    memory usage: 20.1+ MB



```python

# 요일, 시간, level1_pnu, level2_pnu
dummy_fields = ['WEEKDAY','HOUR','level1_pnu','level2_pnu']

for dummy in dummy_fields:
    dummies = pd.get_dummies(df_total[dummy], prefix=dummy, drop_first=False)
    df_total = pd.concat([df_total, dummies], axis=1)
    
df_total = df_total.drop(dummy_fields,axis=1)
df_total.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 109175 entries, 0 to 109174
    Columns: 115 entries, RID to level2_pnu_화성시
    dtypes: float64(6), int64(1), object(3), uint8(105)
    memory usage: 20.1+ MB


# 4. 데이터 스케일링
##  Feature들의 크기, 범주를 정규화하는 과정을 통해 특정변수의 영향도를 조정해줄 수 있습니다.
+ KeyPoint : 데이터 스케일링을 통해 AI모델 학습에 도움을 줄 수 있다.

### 실습5. <u>df_total을 MinMaxScaler로 데이터 스케일링을 진행하고 feature 변수로 저장해주세요.</u>
* 단, 날짜가 스케일링이 되면 안됩니다. 별도로 저장해주었다가 나중에 합쳐주세요.
* data_day = df_total['DAY']


```python
# 아래에 실습코드를 작성하고 결과를 확인합니다.(Hint : from sklearn.preprocessing import MinMaxScaler)
# 스케일링이 불가능한 데이터(문자형, 날짜형 등)와 우리의 목적인 Target(ET)은 스케일링을 하시면 안됩니다.
```


```python
# 기준일자 저장 : why? 날짜가 스케일링이 되면 안됩니다.
data_day=df_total['DAY']
```


```python
train_data=df_total.drop(['RID','TIME_DEPARTUREDATE','TIME_ARRIVEDATE','ET','ETAA','perhour','DAY'],axis=1)
columnNames=train_data.columns
train_data




```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_DISTANCE</th>
      <th>ETA</th>
      <th>signaltype</th>
      <th>WEEKDAY_0</th>
      <th>WEEKDAY_1</th>
      <th>WEEKDAY_2</th>
      <th>WEEKDAY_3</th>
      <th>WEEKDAY_4</th>
      <th>HOUR_0</th>
      <th>HOUR_1</th>
      <th>...</th>
      <th>level2_pnu_의정부시</th>
      <th>level2_pnu_이천시</th>
      <th>level2_pnu_종로구</th>
      <th>level2_pnu_중구</th>
      <th>level2_pnu_중랑구</th>
      <th>level2_pnu_파주시</th>
      <th>level2_pnu_평택시</th>
      <th>level2_pnu_포천시</th>
      <th>level2_pnu_하남시</th>
      <th>level2_pnu_화성시</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12914.0</td>
      <td>987.624634</td>
      <td>7.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7483.0</td>
      <td>855.933716</td>
      <td>31.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8087.0</td>
      <td>575.954529</td>
      <td>6.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10528.0</td>
      <td>537.117004</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10636.0</td>
      <td>786.352539</td>
      <td>28.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>4457.0</td>
      <td>633.093689</td>
      <td>21.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>5518.0</td>
      <td>377.083557</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>4025.0</td>
      <td>412.308411</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>3372.0</td>
      <td>580.275146</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>3659.0</td>
      <td>365.540833</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows × 108 columns</p>
</div>




```python
# 스케일링
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler(feature_range=(0, 1))
feature = pd.DataFrame(scaler.fit_transform(train_data))
feature.columns=columnNames
feature
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A_DISTANCE</th>
      <th>ETA</th>
      <th>signaltype</th>
      <th>WEEKDAY_0</th>
      <th>WEEKDAY_1</th>
      <th>WEEKDAY_2</th>
      <th>WEEKDAY_3</th>
      <th>WEEKDAY_4</th>
      <th>HOUR_0</th>
      <th>HOUR_1</th>
      <th>...</th>
      <th>level2_pnu_의정부시</th>
      <th>level2_pnu_이천시</th>
      <th>level2_pnu_종로구</th>
      <th>level2_pnu_중구</th>
      <th>level2_pnu_중랑구</th>
      <th>level2_pnu_파주시</th>
      <th>level2_pnu_평택시</th>
      <th>level2_pnu_포천시</th>
      <th>level2_pnu_하남시</th>
      <th>level2_pnu_화성시</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.826167</td>
      <td>0.216722</td>
      <td>0.064815</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.373583</td>
      <td>0.185241</td>
      <td>0.287037</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.423917</td>
      <td>0.118311</td>
      <td>0.055556</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.627333</td>
      <td>0.109026</td>
      <td>0.018519</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.636333</td>
      <td>0.168607</td>
      <td>0.259259</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>109170</th>
      <td>0.121417</td>
      <td>0.131970</td>
      <td>0.194444</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109171</th>
      <td>0.209833</td>
      <td>0.070770</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109172</th>
      <td>0.085417</td>
      <td>0.079190</td>
      <td>0.018519</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109173</th>
      <td>0.031000</td>
      <td>0.119343</td>
      <td>0.092593</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>109174</th>
      <td>0.054917</td>
      <td>0.068010</td>
      <td>0.009259</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>109175 rows × 108 columns</p>
</div>



---

## 다음 단계를 위해서 데이터를 저장하겠습니다.


```python
data_day
```




    0         20
    1         20
    2         20
    3         20
    4         20
              ..
    109170    31
    109171    31
    109172    31
    109173    31
    109174    31
    Name: DAY, Length: 109175, dtype: int64




```python
# 다시 날짜를 합칠께요 : Train/Evaluation 분리를 위해 
feature['DAY']=data_day
# traindata 지정
train_feature=feature[feature['DAY']<=24]
train_feature=train_feature.drop(['DAY'],axis=1)
eval_feature=feature[feature['DAY']>=27]
eval_feature=eval_feature.drop(['DAY'],axis=1)
```


```python
len(feature),len(train_feature),len(eval_feature)
```




    (109175, 55433, 53742)




```python
# target 저장
train_target = df_total[df_total['DAY']<=24]['ET']
train_target
```




    0        1201.534058
    1         823.817017
    2         526.710999
    3         898.581970
    4         957.758972
                ...     
    55428     544.301025
    55429     535.666992
    55430     610.799988
    55431     878.479004
    55432     553.580994
    Name: ET, Length: 55433, dtype: float64




```python
# CSV로 저장
train_feature.to_csv('onenavi_train_feature.csv',index = False,sep='|')
train_target.to_csv('onenavi_train_target.csv',index = False,sep='|')
eval_feature.to_csv('onenavi_eval_feature.csv',index = False,sep='|')
```


```python
feature.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 109175 entries, 0 to 109174
    Columns: 109 entries, A_DISTANCE to DAY
    dtypes: float64(108), int64(1)
    memory usage: 90.8 MB



```python
train_feature.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 55433 entries, 0 to 55432
    Columns: 108 entries, A_DISTANCE to level2_pnu_화성시
    dtypes: float64(108)
    memory usage: 46.1 MB



```python

```


```python

```
